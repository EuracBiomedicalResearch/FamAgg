<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Pedigree data information — FAData-class • FamAgg</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Pedigree data information — FAData-class" />
<meta property="og:description" content="FAData objects conveniently store pedigree along with trait
  information. This object is the central data structure from the
  FamAgg package. Basic usage pedigree analysis methods are
  described on this page and on the PedigreeUtils help
  page, familial aggregation analysis methods on the
  PedigreeAnalysis help page.
See the section about the pedigree data.frame below for
  a detailed description of the encoding of missing trait data or
  founder individuals in FamAgg." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FamAgg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.17.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/FamAgg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/EuracBiomedicalResearch/FamAgg/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pedigree data information</h1>
    
    <div class="hidden name"><code>FAData.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>FAData</code> objects conveniently store pedigree along with trait
  information. This object is the central data structure from the
  <code>FamAgg</code> package. Basic usage pedigree analysis methods are
  described on this page and on the <code><a href='Pedigree-utils.html'>PedigreeUtils</a></code> help
  page, familial aggregation analysis methods on the
  <code><a href='FAData-analysis.html'>PedigreeAnalysis</a></code> help page.</p>
<p>See the section about the <code>pedigree</code> <code>data.frame</code> below for
  a detailed description of the encoding of missing trait data or
  founder individuals in <code>FamAgg</code>.</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for FAData</span>
<span class='fu'>affectedIndividuals</span>(<span class='no'>object</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>age</span>(<span class='no'>object</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>age</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for FAData</span>
<span class='fu'>buildPed</span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>family</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>max.generations.up</span><span class='kw'>=</span><span class='fl'>3</span>,
                            <span class='kw'>max.generations.down</span><span class='kw'>=</span><span class='fl'>16</span>, <span class='kw'>prune</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='no'>...</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>export</span>(<span class='no'>object</span>, <span class='no'>con</span>, <span class='kw'>format</span><span class='kw'>=</span><span class='st'>"ped"</span>, <span class='no'>...</span>)

<span class='fu'>FAData</span>(<span class='no'>pedigree</span>, <span class='no'>age</span>, <span class='no'>trait</span>, <span class='no'>traitName</span>, <span class='kw'>header</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>sep</span><span class='kw'>=</span><span class='st'>"\t"</span>, <span class='kw'>id.col</span><span class='kw'>=</span><span class='st'>"id"</span>,
       <span class='kw'>family.col</span><span class='kw'>=</span><span class='st'>"family"</span>, <span class='kw'>father.col</span><span class='kw'>=</span><span class='st'>"father"</span>, <span class='kw'>mother.col</span><span class='kw'>=</span><span class='st'>"mother"</span>,
       <span class='kw'>sex.col</span><span class='kw'>=</span><span class='st'>"sex"</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>family</span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='kw'>NULL</span>,
                          <span class='kw'>return.type</span><span class='kw'>=</span><span class='st'>"data.frame"</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>kinship</span>(<span class='no'>id</span>, <span class='no'>...</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>pedigree</span>(<span class='no'>object</span>, <span class='kw'>return.type</span><span class='kw'>=</span><span class='st'>"data.frame"</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>pedigree</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for FAData</span>
<span class='fu'>pedigreeSize</span>(<span class='no'>object</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>phenotypedIndividuals</span>(<span class='no'>object</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>plotPed</span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>filename</span><span class='kw'>=</span><span class='kw'>NULL</span>,
                           <span class='kw'>device</span><span class='kw'>=</span><span class='st'>"plot"</span>, <span class='kw'>symbol.related</span><span class='kw'>=</span><span class='fl'>NA</span>,
                           <span class='kw'>proband.id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>highlight.ids</span><span class='kw'>=</span><span class='kw'>NULL</span>,
                           <span class='kw'>only.phenotyped</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
                           <span class='kw'>label1</span><span class='kw'>=</span><span class='fu'>age</span>(<span class='no'>object</span>), <span class='kw'>label2</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>label3</span><span class='kw'>=</span><span class='kw'>NULL</span>,
                           <span class='no'>...</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>show</span>(<span class='no'>object</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>trait</span>(<span class='no'>object</span>, <span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>FALSE</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>trait</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>age</th>
      <td><p>For <code>FAData</code>: either a character(1) specifying the file name
    from which the age should be read or a named numeric vector of ages
    with the names corresponding to the ids of the individuals in the
    pedigree.</p></td>
    </tr>
    <tr>
      <th>con</th>
      <td><p>For <code>export</code>: the file name or connection to a file to which
    the pedigree information should be exported.</p></td>
    </tr>
    <tr>
      <th>device</th>
      <td><p>For <code>plotPed</code>: the device of file format in which the plot
    should be saved. See details for allowed values.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>For <code>buildPed</code>: the id of the family for which the pedigree
    should be returned.
    For <code>family</code>: the id of the family for which the pedigree
    should be returned (full pedigree of the family).
    For <code>plotPed</code>: the id of the family for which the pedigree
    should be plotted.</p></td>
    </tr>
    <tr>
      <th>family.col</th>
      <td><p>For <code>FAData</code>: the name of the column containing the id of the
    families.</p></td>
    </tr>
    <tr>
      <th>father.col</th>
      <td><p>For <code>FAData</code>: the name of the column containing the id of the
    father.</p></td>
    </tr>
    <tr>
      <th>filename</th>
      <td><p>For <code>plotPed</code>: a character string specifying the name of the
    file to which the plot should be saved. If none is submitted, the
    plot is saved to a temporary file.</p></td>
    </tr>
    <tr>
      <th>format</th>
      <td><p>For <code>export</code>: the format in which the pedigree should be
    exported. At present only <code>"ped"</code> and <code>"fam"</code> are
    exported, i.e. the file formats from plink
    (<a href='http://pngu.mgh.harvard.edu/~purcell/plink/data.shtml'>http://pngu.mgh.harvard.edu/~purcell/plink/data.shtml</a>).</p></td>
    </tr>
    <tr>
      <th>header</th>
      <td><p>For <code>FAData</code>: only used if argument <code>pedigree</code> is a
    <code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code>, i.e. the file name from which the pedigree
    should be read. The <code>header</code> argument is passed to the
    <code>read.table</code> function, i.e. should be set to <code>TRUE</code> if the
    file contains column headers.</p></td>
    </tr>
    <tr>
      <th>highlight.ids</th>
      <td><p>A list of character vector(s) of ids that should be labeled. The
    name(s) of the character vector(s) is/are used as the text to label
    the individuals (the text is shown below the symbol of the
    individuals). Up to 3 character vectors are
    supported. Alternatively, a single character vector of ids can be
    submitted in which case the individuals are labeled with an asterisc
    (<code><a href='https://rdrr.io/r/base/Arithmetic.html'>"*"</a></code>).</p></td>
    </tr>
    <tr>
      <th>id</th>
      <td><p>For method <code>kinship</code>: the <code>FAData</code> object from which
    the kinship matrix should be extracted, for all other methods the id
    of the individual.</p>
<p>For method <code>plotPed</code>: the id of the individual for which the
    pedigree should be built (see <code>buildPed</code>) and plotted.</p>
<p>Note: <code>id</code> can be a <code>numeric</code> or a
    <code>character</code>. Numeric ids are internally converted to
    <code>character</code>.</p></td>
    </tr>
    <tr>
      <th>id.col</th>
      <td><p>For <code>FAData</code>: the name of the column containing the id of the
    individuals.</p></td>
    </tr>
    <tr>
      <th>label1</th>
      <td><p>For <code>plotPed</code>: labels that should be plotted below the symbol
    for each individual. Should be either a named vector with names
    corresponding to the ids of the individuals in the pedigree or a
    vector of the same length than individuals that are to be
    plotted. For the former it is sufficient to just specify the labels
    for the individuals that should be shown.</p></td>
    </tr>
    <tr>
      <th>label2</th>
      <td><p>For <code>plotPed</code>: see <code>label1</code>. The labels are plotted in the
    second line below the symbol if <code>HaploPainter</code> is used to
    generate the plot, or on the top left corner of the individual's
    symbol for <code>kinship2</code> plotting.</p></td>
    </tr>
    <tr>
      <th>label3</th>
      <td><p>For <code>plotPed</code>: see <code>label1</code>. The labels are plotted in the
    third line below the symbol if <code>HaploPainter</code> is used to
    generate the plot, or on the top right corner of the individual's
    symbol for <code>kinship2</code> plotting.</p></td>
    </tr>
    <tr>
      <th>max.generations.down</th>
      <td><p>For <code>buildPed</code>: the maximal number of generations to look for
    children.</p></td>
    </tr>
    <tr>
      <th>max.generations.up</th>
      <td><p>For <code>buildPed</code>: the maximal number of generations to look for
    ancestors.</p></td>
    </tr>
    <tr>
      <th>mother.col</th>
      <td><p>For <code>FAData</code>: the name of the column containing the id of the
    mother.</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>For <code>trait</code>: whether missing values in trait should be returned
    or not.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>The <code>FAData</code> object.</p></td>
    </tr>
    <tr>
      <th>only.phenotyped</th>
      <td><p>Wheter only phenotyped individuals, i.e. individuals with a non-NA
    value in column <code>affected</code> (the trait information). Requires
    this information to be present.</p></td>
    </tr>
    <tr>
      <th>pedigree</th>
      <td><p>For <code>FAData</code>: either a <code>data.frame</code> with the pedigree
    information or a <code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code> specifying the file name from
    which the pedigree should be read. See description below for more
    details.</p></td>
    </tr>
    <tr>
      <th>proband.id</th>
      <td><p>For <code>plotPed</code>: character vector with the id(s) of one ore more
    individuals that should be highlighted as probands.
    <code>HaploPainter</code> indicates probands with a <code>"P"</code> next to the
    symbol and an arrow pointing to the symbol.</p></td>
    </tr>
    <tr>
      <th>prune</th>
      <td><p>For <code>buildPed</code>: whether the smallest possible (connected)
    pedigree for the submitted ids should be build. This makes only
    sense if more than one id is submitted.</p></td>
    </tr>
    <tr>
      <th>return.type</th>
      <td><p>Either <code>"data.frame"</code> or <code>"pedigree"</code> if the pedigree
    information should be returned as a <code>data.frame</code> or
    <code>pedigreeList</code> object as defined in the <code>kinship2</code>
    package.</p></td>
    </tr>
    <tr>
      <th>sep</th>
      <td><p>For <code>FAData</code>: only used if argument <code>pedigree</code> is a
    <code><a href='https://rdrr.io/r/base/character.html'>character(1)</a></code>, i.e. the file name from which the pedigree
    should be read. The <code>sep</code> argument is passed to the
    <code>read.table</code> function and specifies the field separator.</p></td>
    </tr>
    <tr>
      <th>sex.col</th>
      <td><p>For <code>FAData</code>: the name of the column spefifying the sex of the
    individuals.</p></td>
    </tr>
    <tr>
      <th>symbol.related</th>
      <td><p>For <code>plotPed</code>: the symbol which should be used to label
    individuals sharing kinship with the id for which the pedigree is
    generated and plotted.</p></td>
    </tr>
    <tr>
      <th>trait</th>
      <td><p>For <code>FAData</code>: a numeric vector with <code>0</code>, <code>1</code> and
    <code>NA</code> or a logical vector indicating unaffected (but
    phenotyped), affected and not phenotyped individuals.</p></td>
    </tr>
    <tr>
      <th>traitName</th>
      <td><p>For <code>FAData</code>: an optional name for the trait.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>For <code>age&lt;-</code>: a named numeric vector. The names (at least some
    of them) have to match the ids in the pedigree of the object.</p>
<p>For <code>pedigree&lt;-</code>:</p>
<p>For <code>trait&lt;-</code>: a named numeric vector with <code>0</code>, <code>1</code>
    and <code>NA</code> or a logical vector with <code>FALSE</code>, <code>TRUE</code>,
    <code>NA</code> for not affected, affected and not tested. The names (at
    least some of them) have to match the ids in the pedigree of the
    object.</p>
<p></p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to be passed to the plotting functions
    (<code><a href='plotting-functions.html'>doPlotPed</a></code> for <code>plotPed</code>).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="objects-from-the-class"><a class="anchor" href="#objects-from-the-class"></a>Objects from the Class</h2>

    <p><code>FAData</code> objects are created by the constructor function
  <code>FAData</code> and should not be directly created by a call to
  <code>new</code>.</p>
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    <p></p><dl>
    <dt>age</dt><dd><p>A (named) numerical vector with the age of the individuals. It is
      suggested to use the getter and setter methods described below to
      access this slot.</p></dd>

    <dt>pedigree</dt><dd><p>A <code>data.frame</code> with the pedigree. It is suggested to use the
      getter and setter methods described below to access this slot.</p></dd>

    <dt>.kinship</dt><dd><p>The kinship matrix for the kinship of each individual in the
      pedigree with each other. This slot should not be accessed
      directly, but the <code>kinship</code> method should be used
      instead.</p></dd>

    <dt>traitname</dt><dd><p>The name of the trait being stored in the object.</p></dd>

    <dt>.trait</dt><dd><p>A numerical vector with the trait information, <code>0</code>, <code>1</code>,
      <code>NA</code>, for phenotyped but not affected, affected and not
      tested, respectively. This slot should not be accessed directly,
      but the <code>trait</code> and <code>trait&lt;-</code> methods should be used
      instead that ensure that the data is matched to the information in
      the pedigree.</p></dd>

  
</dl>

    <h2 class="hasAnchor" id="constructors-importing-and-exporting-data"><a class="anchor" href="#constructors-importing-and-exporting-data"></a>Constructors, importing and exporting data</h2>

    <p></p><dl>
    <dt>FAData</dt><dd><p>Constructor function to create a new <code>FAData</code> instance. In
      addition to submitting the pedigree information as
      <code>data.frame</code>, <code>pedigree</code> or <code>pedigreeLinst</code> it is
      possible to specify the name of the file from which the pedigree
      information should be read.
      The recognizes and imports plink <em>ped</em> and <code>fam</code> files
      (<a href='http://pngu.mgh.harvard.edu/~purcell/plink/data.shtml'>http://pngu.mgh.harvard.edu/~purcell/plink/data.shtml</a>) or from
      generic text files.
      For the latter, arguments
      <code>header</code>, <code>sep</code>, <code>family.col</code>, <code>id.col</code>,
      <code>father.col</code>, <code>mother.col</code> and <code>sex.col</code> allow to
      further specify which columns of the file contain what information
      etc.
      If argument <code>pedigree</code> is a <code>data.frame</code>, the column
      names <code>"family"</code>, <code>"id"</code>, <code>"father"</code>,
      <code>"mother"</code> and <code>"sex"</code> are expected. Any additional
      columns are dropped.      The sex is expected to be encoded either as a numeric 1 (male),
      2 (female) with any other number or <code>NA</code> representing
      unknown, or as a character vector or factor with <code>"M"</code>,
      <code>"m"</code>, <code>"Male"</code> or <code>"male"</code> for male and <code>"F"</code>,
      <code>"f"</code>, <code>"Female"</code> or <code>"female"</code> for female.</p></dd>

    <dt>export</dt><dd><p>Export pedigree data to a file.</p></dd>
  
</dl>

    <h2 class="hasAnchor" id="accessors-and-subsetting"><a class="anchor" href="#accessors-and-subsetting"></a>Accessors and subsetting</h2>

    <p></p><dl>

    <dt>object$name</dt><dd><p>Access <code>name</code> column in the pedigree of the <code>FAData</code>
      object. The function returns a named vector wirh the names
      corresponding to the ids of the individuals or <code>NULL</code> if
      <code>name</code> does not correspoind to a column name in the pedigree.
      The trait data can be accessed either by <code>object$trait</code> or
      <code>object$affected</code>.</p></dd>

    <dt>age</dt><dd><p>Returns the age of the individuals as a named numeric vector.
      If the pedigree is set, the order of the values corresponds always
      to the ordering of the individuals in the pedigree with <code>NA</code>
      for individuals for which the age is unknown. In case the age was
      never set it returns a vector of NAs with length equal to the
      number of individuals.</p></dd>

    <dt>age&lt;-</dt><dd><p>Setter for the age. Value has to be a named numeric vector.</p></dd>

    <dt>pedigree</dt><dd><p>Returns the pedigree either as a <code>data.frame</code> or a
      <code>pedigreeList</code> object (defined in the <code>kinship2</code>
      package) depending on the value of the parameter
      <code>return.type</code> (i.e. either <code>return.type="data.frame"</code> or
      <code>return.type="pedigree"</code>). If <code>pedigree</code> is called on
      any other object than a <code>FAData</code> object (or any object
      that inherits from that object), the
      <code><a href='https://rdrr.io/pkg/kinship2/man/pedigree.html'>pedigree</a></code> method from the
      <code>kinship2</code> package is called.      For the default return type (i.e. <code>return.type="data.frame"</code>)
      a <code>data.frame</code> is returned with the following columns:
      <code>"family"</code>: the ID of the family,
      <code>"id"</code>: the ID of the individual,
      <code>"father"</code>: the ID of the individual's father. Founder
      individuals, i.e. individuals for whom the father and mother is
      not known in the data set, contain a <code>NA</code> in this column.
      <code>"mother"</code>: the ID of the individual's father. Founder
      individuals, i.e. individuals for whom the father and mother is
      not known in the data set, contain a <code>NA</code> in this column.
      <code>"sex"</code>: the sex of the individuals encoded as a
      <code>factor</code> with levels <code>"M"</code> and <code>"F"</code> for male and
      female, or <code>NA</code> for not known.
      If trait information is available in the object the returned
      <code>data.frame</code> will also contain a column named <code>affected</code>
      with the information whether the individual is affected
      (<code>1</code>), not affected (<code>0</code>) or was not tested/phenotyped
      <code>NA</code>.</p></dd>

    <dt>pedigree&lt;-</dt><dd><p>Setter for the pedigree slow. Value can be a <code>data.frame</code>
      with columns containing the family id, individual id, father id,
      mother id and sex (in this order) or a <code>pedigree</code> or
      <code>pedigreeList</code> object as defined in the <code>kinship2</code>
      package.</p></dd>

    <dt>object[i, ]</dt><dd><p>Subsets the <code>FAData</code> object to individuals specified with
      <code>i</code> which can be a logical, numeric or character vector. For
      the latter, the elements have to be the ids of the individuals
      (i.e. rownames of <code>pedigree(object)</code>). Returns the sub-setted
      object.
      Note that subsetting other than by family might result in a
      non-valid pedigree (e.g. if mother or father ID are not available
      in the sub-setted pedigree).</p></dd>

    <dt>trait</dt><dd><p>Get the trait vector from the object. By default, the ordering
      is the same as pedigree, setting argument <code>na.rm=TRUE</code>
      removes all <code>NA</code> values, thus the ordering and length might
      be different. Returns a named vector with the names corresponding
      to the ids of the individuals.</p></dd>

    <dt>trait&lt;-</dt><dd><p>Setter for the trait slot. Can be a named numeric vector (values
      <code>0</code>, <code>1</code> and <code>NA</code>) or logical vector (values
      <code>FALSE</code>, <code>TRUE</code> and <code>NA</code>) with the names matching
      the ids of the individuals in the pedigree. The method internally
      matches and re-orders the trait vector to match the ordering of
      the ids in the pedigree.</p></dd>

  
</dl>

    <h2 class="hasAnchor" id="basic-usage"><a class="anchor" href="#basic-usage"></a>Basic usage</h2>

    <p></p><dl>

    <dt>affectedIndividuals</dt><dd><p>Returns a character vector with the ids of the affected
      individuals, i.e. the id of the individuals with a value other
      than 0 or <code>NA</code> in the trait.
      If no trait data is available the method returns <code>NULL</code>.</p></dd>

    <dt>buildPed</dt><dd><p>Builds a pedigree for the specified id(s) containing generations
      defined by <code>max.generations.up</code> and
      <code>max.generations.down</code> and returns it as a
      <code>data.frame</code>. The pedigree contains all individuals in the
      family sharing kinship with the input individual(s) and mates
      needed to complete the pedigree.
      For <code>prune=TRUE</code> the function tries to
      find the smallest connected pedigree for all the submitted ids.</p></dd>

    <dt>family</dt><dd><p>Returns the pedigree for a full family. In contrast to
      <code>buildPed</code> which constructs a (sub)pedigree for a specific
      individual, this method returns the pedigree of the complete
      family for an individual (if <code>id</code> is specified). The function
      returns either a <code>data.frame</code> or a <code>pedigreeList</code> with
      the pedigree for the family.</p></dd>

    <dt>kinship</dt><dd><p>Extracts the pre-calculated kinship matrix, i.e. a symmetric
      matrix with the kinship between all individuals in the
      pedigree. The matrix is calculated using the <code>kinship</code> method
      provided by the <code>kinship2</code> package [Sinwell (2014)].
      The function returns a <code>dsCMatrix</code> from the <code>Matrix</code>
      package.</p></dd>

    <dt>pedigreeSize</dt><dd><p>Returns the size, i.e. the number of individuals (rows) in the
      pedigree.</p></dd>

    <dt>phenotypedIndividuals</dt><dd><p>Returns a character vector with the ids of the phenotyped
      individuals, i.e. the id of all individuals that have a non-NA
      value in thetrait.
      If no trait data is available the method returns <code>NULL</code>.</p></dd>

    <dt>plotPed</dt><dd><p>Creates the pedigree for the submitted id(s) or family and plots
      it (i.e. saves it to the specified file). See details above for
      more information.
      Returns the file name of the file to which the pedigree plot was
      exported or <code>NULL</code> for <code>kinship2</code> plotting and
      <code>device="plot"</code>.      For <code>HaploPainter</code> plotting and <code>device = "txt"</code> the name
      of the file to which the plotting data has been exported is returned.      See <code><a href='plotting-functions.html'>doPlotPed</a></code> for more information.</p></dd>

  
</dl>

    <h2 class="hasAnchor" id="pedigree-analysis-methods"><a class="anchor" href="#pedigree-analysis-methods"></a>Pedigree analysis methods</h2>

    <p>Methods for familial aggregation and other pedigree analysis methods
  are described on the <a href='FAData-analysis.html'>PedigreeAnalysis</a> help page.</p>
    <h2 class="hasAnchor" id="pedigree-utilities"><a class="anchor" href="#pedigree-utilities"></a>Pedigree utilities</h2>

    <p>A variety of different pedigree utilities are defined for
  <code>FAData</code> objects. For the full list of methods see the
  <a href='Pedigree-utils.html'>PedigreeUtils</a> help page.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    

<p>See sections below for a description of the individual methods.</p>
<p>The <code>buildPed</code> method is a combination of the methods
  <code>getAncestors</code>, <code>getChildren</code> and <code>getMissingMate</code>,
  i.e. it first gets all ancestors for the specified id(s), determines
  then the children of all of the ids (submitted ids and their
  ancestors) and at last looks for any missing mates/spouses to complete
  the pedigree.</p>
<p>The <code>plotPed</code> function uses either the external perl program
  <code>HaploPainter</code> or the plotting capabilities of the
  <code>kinship2</code> package.
  With <code>HaploPainter</code>, as it is an external too, it is not possible
  to display the plot directly, but each plot is automatically saved to
  a file (either <code>"pdf"</code>, <code>"ps"</code>, <code>"svg"</code> or
  <code>"png"</code>; can be specified with the <code>device</code>
  parameter). <code>HaploPainter</code> plotting supports also <code>device =
  "txt"</code> in which case the data table is exported (in the format
  expected by <code>HaploPainter</code>) to a tabulator delimited text file
  and the name of this text file is returned - no plot is created.
  Plotting with <code>kinship2</code> (the default) allows to display the plot
  (<code>device="plot"</code>) or export it to a file (<code>device="pdf"</code> or
  <code>device="png"</code>).</p>
<p>The <code><a href='plotting-functions.html'>switchPlotfun</a></code> function can be used to change the plotting
  system.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The ids of individuals, father, mother and family can be either
  numeric or characters, internally, all ids will however be handled as
  characters.</p>
<p>The <code>pedigree&lt;-</code> setter method removes all white spaces in
  columns <code>"id"</code>, <code>"family"</code>, <code>"father"</code> and
  <code>"mother"</code> of the pedigree.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Refer to the method and function description above for detailed
  information on the returned result object.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Sinwell JP, Therneau TM &amp; Schaid DJ (2014) The kinship2 R package for
  pedigree data. <em>Human heredity</em> 78:91-93.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/kinship2/man/pedigree.html'>pedigree</a></code>,
  <code><a href='FAProbResults.html'>FAProbResults</a></code>,
  <code><a href='FAKinGroupResults.html'>FAKinGroupResults</a></code>,
  <code><a href='FAKinSumResults.html'>FAKinSumResults</a></code>,
  <code><a href='FAGenIndexResults.html'>FAGenIndexResults</a></code>,
  <code><a href='plotting-functions.html'>doPlotPed</a></code>,
  <code><a href='Pedigree-utils.html'>PedigreeUtils</a></code>,
  <code><a href='defineControls.html'>getAll</a></code>,
  <code><a href='FAData-analysis.html'>PedigreeAnalysis</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>##########################</span>
<span class='co'>##</span>
<span class='co'>##  Create a new FAData object</span>
<span class='co'>##</span>
<span class='co'>## Load the Minnesota Breast Cancer record and subset to the</span>
<span class='co'>## first families.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>minnbreast</span>)
<span class='no'>mbsub</span> <span class='kw'>&lt;-</span> <span class='no'>minnbreast</span>[<span class='no'>minnbreast</span>$<span class='no'>famid</span><span class='kw'>==</span><span class='fl'>4</span> <span class='kw'>|</span> <span class='no'>minnbreast</span>$<span class='no'>famid</span><span class='kw'>==</span><span class='fl'>5</span>, ]
<span class='no'>mbped</span> <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>[, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"famid"</span>, <span class='st'>"id"</span>, <span class='st'>"fatherid"</span>, <span class='st'>"motherid"</span>, <span class='st'>"sex"</span>)]
<span class='co'>## Renaming column names</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>mbped</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"family"</span>, <span class='st'>"id"</span>, <span class='st'>"father"</span>, <span class='st'>"mother"</span>, <span class='st'>"sex"</span>)
<span class='co'>## Defining the optional argument age.</span>
<span class='no'>Age</span> <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>$<span class='no'>endage</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>Age</span>) <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>$<span class='no'>id</span>
<span class='co'>## Create the object</span>
<span class='no'>fad</span> <span class='kw'>&lt;-</span> <span class='fu'>FAData</span>(<span class='kw'>pedigree</span><span class='kw'>=</span><span class='no'>mbped</span>, <span class='kw'>age</span><span class='kw'>=</span><span class='no'>Age</span>)</div><div class='output co'>#&gt; <span class='message'>Generating the kinship matrix...</span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'>
<span class='no'>fad</span></div><div class='output co'>#&gt; FAData object with:
#&gt;  * Pedigree of length 81.
#&gt;  * Number of unique individuals: 81.
#&gt;  * Number of families: 2.
#&gt;  * Number of individuals in largest family: 43.
#&gt;  * Number of individuals in smallest family: 38.
#&gt;  * Number of individuals with known age: 45.</div><div class='input'>
<span class='co'>## Extract the ids directly...</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>fad</span>$<span class='no'>id</span>)</div><div class='output co'>#&gt;   1   2   3   4   5   6 
#&gt; "1" "2" "3" "4" "5" "6" </div><div class='input'>
<span class='co'>## Extract the kinship matrix</span>
<span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span>(<span class='fu'>kinship</span>(<span class='no'>fad</span>))</div><div class='output co'>#&gt; [1] 81 81</div><div class='input'>
<span class='co'>## What's the size of the pedigree?</span>
<span class='fu'>pedigreeSize</span>(<span class='no'>fad</span>)</div><div class='output co'>#&gt; [1] 81</div><div class='input'>
<span class='co'>## Importing a "ped" file.</span>
<span class='no'>pedFile</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"txt/minnbreastsub.ped.gz"</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"FamAgg"</span>)
<span class='co'>## Quick glance at the file.</span>
<span class='fu'><a href='https://rdrr.io/r/base/readLines.html'>readLines</a></span>(<span class='no'>pedFile</span>, <span class='kw'>n</span><span class='kw'>=</span><span class='fl'>1</span>)</div><div class='output co'>#&gt; [1] "4\t1\t0\t0\t1\t1"</div><div class='input'><span class='no'>fad</span> <span class='kw'>&lt;-</span> <span class='fu'>FAData</span>(<span class='no'>pedFile</span>)</div><div class='output co'>#&gt; <span class='message'>Reading pedigree information from file  /Users/runner/runners/2.169.1/work/_temp/Library/FamAgg/txt/minnbreastsub.ped.gz ...</span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='output co'>#&gt; <span class='message'>Generating the kinship matrix...</span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'>pedigree</span>(<span class='no'>fad</span>))</div><div class='output co'>#&gt;   family id father mother sex
#&gt; 1      4  1   &lt;NA&gt;   &lt;NA&gt;   M
#&gt; 2      4  2   &lt;NA&gt;   &lt;NA&gt;   F
#&gt; 3      4  3     25      4   F
#&gt; 4      4  4      1      2   F
#&gt; 5      4  5      1      2   M
#&gt; 6      4  6      1      2   M</div><div class='input'>
<span class='co'>## Creating the FAData reading data from a txt file.</span>
<span class='no'>pedFile</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/system.file.html'>system.file</a></span>(<span class='st'>"txt/minnbreastsub.txt"</span>, <span class='kw'>package</span><span class='kw'>=</span><span class='st'>"FamAgg"</span>)
<span class='no'>fad</span> <span class='kw'>&lt;-</span> <span class='fu'>FAData</span>(<span class='kw'>pedigree</span><span class='kw'>=</span><span class='no'>pedFile</span>, <span class='kw'>header</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>id.col</span><span class='kw'>=</span><span class='st'>"id"</span>,
              <span class='kw'>family.col</span><span class='kw'>=</span><span class='st'>"famid"</span>, <span class='kw'>father.col</span><span class='kw'>=</span><span class='st'>"fatherid"</span>,
              <span class='kw'>mother.col</span><span class='kw'>=</span><span class='st'>"motherid"</span>)</div><div class='output co'>#&gt; <span class='message'>Reading pedigree information from file  /Users/runner/runners/2.169.1/work/_temp/Library/FamAgg/txt/minnbreastsub.txt ...</span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='output co'>#&gt; <span class='message'>Generating the kinship matrix...</span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'><span class='co'>## Adding the age</span>
<span class='fu'>age</span>(<span class='no'>fad</span>) <span class='kw'>&lt;-</span> <span class='no'>Age</span>
<span class='no'>fad</span></div><div class='output co'>#&gt; FAData object with:
#&gt;  * Pedigree of length 851.
#&gt;  * Number of unique individuals: 851.
#&gt;  * Number of families: 15.
#&gt;  * Number of individuals in largest family: 105.
#&gt;  * Number of individuals in smallest family: 16.
#&gt;  * Number of individuals with known age: 45.</div><div class='input'><span class='co'>## List all families in the pedigree along with the number of</span>
<span class='co'>## individuals</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>fad</span>$<span class='no'>family</span>)</div><div class='output co'>#&gt; 
#&gt;   4   5   6   7   8   9  10  12  13  14  15  16  17  18  19 
#&gt;  43  38  41  16  40  47  85 100  41  70 105  68  36  95  26 </div><div class='input'>
<span class='co'>##########################</span>
<span class='co'>##</span>
<span class='co'>##  Basic usage</span>
<span class='co'>##</span>
<span class='co'>## Extracting the pedigree information</span>
<span class='no'>ped</span> <span class='kw'>&lt;-</span> <span class='fu'>pedigree</span>(<span class='no'>fad</span>)
<span class='co'>## By default the pedigree is returned as a data.frame.</span>
<span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span>(<span class='no'>ped</span>)</div><div class='output co'>#&gt; [1] "data.frame"</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>ped</span>)</div><div class='output co'>#&gt;   family id father mother sex
#&gt; 1      4  1     NA     NA   M
#&gt; 2      4  2     NA     NA   F
#&gt; 3      4  3     25      4   F
#&gt; 4      4  4      1      2   F
#&gt; 5      4  5      1      2   M
#&gt; 6      4  6      1      2   M</div><div class='input'>
<span class='co'>## In addition, we can extract the pedigree as a pedigreeList</span>
<span class='fu'>pedigree</span>(<span class='no'>fad</span>, <span class='kw'>return.type</span><span class='kw'>=</span><span class='st'>"pedigree"</span>)</div><div class='output co'>#&gt; Pedigree list with 851 total subjects in 15 families</div><div class='input'>
<span class='co'>## Return the ids of all ancestors of individual 6</span>
<span class='co'>## up to 3 generations</span>
<span class='fu'><a href='Pedigree-utils.html'>getAncestors</a></span>(<span class='no'>fad</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='st'>"6"</span>)</div><div class='output co'>#&gt; [1] "1" "2"</div><div class='input'>
<span class='co'>## Build the pedigree for individual 6: this includes all of its</span>
<span class='co'>## children and all of its ancestors up to the maximal number of</span>
<span class='co'>## specified generations.</span>
<span class='fu'>buildPed</span>(<span class='no'>fad</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>6</span>)</div><div class='output co'>#&gt; <span class='message'>Removing singletons...</span></div><div class='output co'>#&gt; <span class='message'> none present.</span></div><div class='output co'>#&gt;    family id father mother sex
#&gt; 1       4  1     NA     NA   M
#&gt; 2       4  2     NA     NA   F
#&gt; 6       4  6      1      2   M
#&gt; 4       4  4      1      2   F
#&gt; 5       4  5      1      2   M
#&gt; 7       4  7      1      2   M
#&gt; 8       4  8      1      2   F
#&gt; 9       4  9      1      2   F
#&gt; 10      4 10      1      2   F
#&gt; 14      4 14      6     27   M
#&gt; 15      4 15      6     27   M
#&gt; 16      4 16      6     27   F
#&gt; 3       4  3     25      4   F
#&gt; 11      4 11      5     26   M
#&gt; 12      4 12      5     26   F
#&gt; 13      4 13      5     26   F
#&gt; 17      4 17     28      8   M
#&gt; 18      4 18     29      9   M
#&gt; 19      4 19     29      9   F
#&gt; 20      4 20     29      9   F
#&gt; 21      4 21     24      3   M
#&gt; 22      4 22     24      3   F
#&gt; 23      4 23     24      3   F
#&gt; 25      4 25     NA     NA   M
#&gt; 28      4 28     NA     NA   M
#&gt; 29      4 29     NA     NA   M
#&gt; 24      4 24     NA     NA   M
#&gt; 26      4 26     NA     NA   F
#&gt; 27      4 27     NA     NA   F</div><div class='input'><span class='co'>## Which is a sub-pedigree of the complete family:</span>
<span class='fu'>family</span>(<span class='no'>fad</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>6</span>)</div><div class='output co'>#&gt;    family id father mother sex
#&gt; 1       4  1     NA     NA   M
#&gt; 2       4  2     NA     NA   F
#&gt; 3       4  3     25      4   F
#&gt; 4       4  4      1      2   F
#&gt; 5       4  5      1      2   M
#&gt; 6       4  6      1      2   M
#&gt; 7       4  7      1      2   M
#&gt; 8       4  8      1      2   F
#&gt; 9       4  9      1      2   F
#&gt; 10      4 10      1      2   F
#&gt; 11      4 11      5     26   M
#&gt; 12      4 12      5     26   F
#&gt; 13      4 13      5     26   F
#&gt; 14      4 14      6     27   M
#&gt; 15      4 15      6     27   M
#&gt; 16      4 16      6     27   F
#&gt; 17      4 17     28      8   M
#&gt; 18      4 18     29      9   M
#&gt; 19      4 19     29      9   F
#&gt; 20      4 20     29      9   F
#&gt; 21      4 21     24      3   M
#&gt; 22      4 22     24      3   F
#&gt; 23      4 23     24      3   F
#&gt; 24      4 24     NA     NA   M
#&gt; 25      4 25     NA     NA   M
#&gt; 26      4 26     NA     NA   F
#&gt; 27      4 27     NA     NA   F
#&gt; 28      4 28     NA     NA   M
#&gt; 29      4 29     NA     NA   M
#&gt; 30      4 30     NA     NA   M
#&gt; 31      4 31     NA     NA   F
#&gt; 32      4 32     NA     NA   M
#&gt; 33      4 33     NA     NA   M
#&gt; 34      4 34     NA     NA   F
#&gt; 35      4 35     NA     NA   F
#&gt; 36      4 36     NA     NA   M
#&gt; 37      4 37     NA     NA   F
#&gt; 38      4 38     NA     NA   M
#&gt; 39      4 39     NA     NA   M
#&gt; 40      4 40     NA     NA   F
#&gt; 41      4 41     NA     NA   M
#&gt; 42      4 42     NA     NA   M
#&gt; 43      4 43     NA     NA   F</div><div class='input'>
<span class='co'>## In addition we can specify manually some ids in the pedigree and</span>
<span class='co'>## generate the smallest possible pedigree containing all ids:</span>
<span class='fu'>buildPed</span>(<span class='no'>fad</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>6</span>, <span class='fl'>23</span>, <span class='fl'>28</span>), <span class='kw'>prune</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='message'>Removing singletons...</span></div><div class='output co'>#&gt; <span class='message'> 1 removed.</span></div><div class='output co'>#&gt;    family id father mother sex
#&gt; 3       4  3     25      4   F
#&gt; 4       4  4      1      2   F
#&gt; 1       4  1     NA     NA   M
#&gt; 6       4  6      1      2   M
#&gt; 8       4  8      1      2   F
#&gt; 28      4 28     NA     NA   M
#&gt; 17      4 17     28      8   M
#&gt; 23      4 23     24      3   F
#&gt; 2       4  2     NA     NA   F
#&gt; 25      4 25     NA     NA   M
#&gt; 24      4 24     NA     NA   M</div><div class='input'>
<span class='co'>## Get the list of all ids sharing kinship with individuals</span>
<span class='co'>## 5 and 9</span>
<span class='fu'><a href='Pedigree-utils.html'>shareKinship</a></span>(<span class='no'>fad</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"5"</span>, <span class='st'>"9"</span>))</div><div class='output co'>#&gt;  [1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "11" "12" "13" "14" "15"
#&gt; [16] "16" "17" "18" "19" "20" "21" "22" "23"</div><div class='input'>
<span class='co'>## Subset the fad to family "4"</span>
<span class='no'>subFad</span> <span class='kw'>&lt;-</span> <span class='no'>fad</span>[<span class='no'>fad</span>$<span class='no'>family</span> <span class='kw'>==</span> <span class='st'>"4"</span>, ]
<span class='no'>subFad</span></div><div class='output co'>#&gt; FAData object with:
#&gt;  * Pedigree of length 43.
#&gt;  * Number of unique individuals: 43.
#&gt;  * Number of families: 1.
#&gt;  * Number of individuals in largest family: 43.
#&gt;  * Number of individuals in smallest family: 43.
#&gt;  * Number of individuals with known age: 28.</div><div class='input'>
<span class='co'>## Export the pedigree from this family to a ped file</span>
<span class='no'>tmpFile</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/tempfile.html'>tempfile</a></span>()
<span class='fu'>export</span>(<span class='no'>subFad</span>, <span class='kw'>con</span><span class='kw'>=</span><span class='no'>tmpFile</span>, <span class='kw'>format</span><span class='kw'>=</span><span class='st'>"ped"</span>)

<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='https://rdrr.io/r/utils/read.table.html'>read.table</a></span>(<span class='no'>tmpFile</span>, <span class='kw'>sep</span><span class='kw'>=</span><span class='st'>"\t"</span>))</div><div class='output co'>#&gt;   V1 V2 V3 V4 V5 V6
#&gt; 1  4  1  0  0  1  0
#&gt; 2  4  2  0  0  2  0
#&gt; 3  4  3 25  4  2  0
#&gt; 4  4  4  1  2  2  0
#&gt; 5  4  5  1  2  1  0
#&gt; 6  4  6  1  2  1  0</div><div class='input'>
<span class='co'>##########################</span>
<span class='co'>##</span>
<span class='co'>##  Plotting</span>
<span class='co'>##</span>
<span class='co'>## Plot the pedigree for individual 6.</span>
<span class='fu'>plotPed</span>(<span class='no'>fad</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>6</span>)</div><div class='output co'>#&gt; <span class='message'>Removing singletons...</span></div><div class='output co'>#&gt; <span class='message'> none present.</span></div><div class='img'><img src='FAData-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Alternatively, exporte it to a temporary file</span>
<span class='no'>pfile</span> <span class='kw'>&lt;-</span> <span class='fu'>plotPed</span>(<span class='no'>fad</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>6</span>, <span class='kw'>device</span><span class='kw'>=</span><span class='st'>"pdf"</span>)</div><div class='output co'>#&gt; <span class='message'>Removing singletons...</span></div><div class='output co'>#&gt; <span class='message'> none present.</span></div><div class='input'><span class='no'>pfile</span></div><div class='output co'>#&gt; [1] "/var/folders/24/8k48jl6d249_n_qfxwsl6xvm0000gn/T//RtmpNmbsKA/file83478e9abf6.pdf"</div><div class='input'>
<span class='co'>## Highlighting some of the individuals:</span>
<span class='co'>## first get to know which other individuals are in the pedigree</span>
<span class='fu'>plotPed</span>(<span class='no'>fad</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>6</span>, <span class='kw'>highlight.ids</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>hello</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>, <span class='fl'>4</span>)))</div><div class='output co'>#&gt; <span class='message'>Removing singletons...</span></div><div class='output co'>#&gt; <span class='message'> none present.</span></div><div class='img'><img src='FAData-2.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'>##########################</span>
<span class='co'>##</span>
<span class='co'>##  Adding trait data</span>
<span class='co'>##</span>
<span class='no'>fad</span> <span class='kw'>&lt;-</span> <span class='fu'>FAData</span>(<span class='kw'>pedigree</span><span class='kw'>=</span><span class='no'>mbped</span>, <span class='kw'>age</span><span class='kw'>=</span><span class='no'>Age</span>)</div><div class='output co'>#&gt; <span class='message'>Generating the kinship matrix...</span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'><span class='no'>tcancer</span> <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>$<span class='no'>cancer</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>tcancer</span>) <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>$<span class='no'>id</span>
<span class='fu'>trait</span>(<span class='no'>fad</span>) <span class='kw'>&lt;-</span> <span class='no'>tcancer</span></div><div class='output co'>#&gt; <span class='message'>81 of in total 81 trait values can be matched to IDs in the pedigree.</span></div><div class='input'><span class='co'>## Now we can plot the pedigree also showing the affected status.</span>
<span class='fu'>plotPed</span>(<span class='no'>fad</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>6</span>)</div><div class='output co'>#&gt; <span class='message'>Removing singletons...</span></div><div class='output co'>#&gt; <span class='message'> none present.</span></div><div class='img'><img src='FAData-3.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'>## Alternatively, create the FAData with the trait data</span>
<span class='no'>fad</span> <span class='kw'>&lt;-</span> <span class='fu'>FAData</span>(<span class='kw'>pedigree</span><span class='kw'>=</span><span class='no'>mbped</span>, <span class='kw'>trait</span><span class='kw'>=</span><span class='no'>mbsub</span>$<span class='no'>cancer</span>, <span class='kw'>traitName</span><span class='kw'>=</span><span class='st'>"cancer"</span>)</div><div class='output co'>#&gt; <span class='message'>Generating the kinship matrix...</span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='output co'>#&gt; <span class='message'>81 of in total 81 trait values can be matched to IDs in the pedigree.</span></div><div class='input'><span class='fu'>plotPed</span>(<span class='no'>fad</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fl'>6</span>)</div><div class='output co'>#&gt; <span class='message'>Removing singletons...</span></div><div class='output co'>#&gt; <span class='message'> none present.</span></div><div class='img'><img src='FAData-4.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Johannes Rainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


