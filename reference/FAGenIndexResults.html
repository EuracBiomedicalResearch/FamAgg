<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Genealogical Index — FAGenIndexResults-class • FamAgg</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Genealogical Index — FAGenIndexResults-class" />
<meta property="og:description" content="The genealogical index [Hill, 1980], also referred to as the
  genealogical index of familiality (GIF) in the literature, is a
  method to identify familial clustering of diseases or other traits.
  For a given trait,
  the method computes the mean kinship between affected in the
  whole pedigree along with mean kinships of randomly drawn sets of
  individuals. The distribution of average kinship values among the
  control sets is used to estimate the probability that the observed
  level of kinship among the cases is due to chance." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FamAgg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.17.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/FamAgg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/EuracBiomedicalResearch/FamAgg/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Genealogical Index</h1>
    
    <div class="hidden name"><code>FAGenIndexResults.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The genealogical index [Hill, 1980], also referred to as the
  <em>genealogical index of familiality</em> (GIF) in the literature, is a
  method to identify familial clustering of diseases or other traits.
  For a given trait,
  the method computes the mean kinship between affected in the
  whole pedigree along with mean kinships of randomly drawn sets of
  individuals. The distribution of average kinship values among the
  control sets is used to estimate the probability that the observed
  level of kinship among the cases is due to chance.</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for FAGenIndexResults</span>
<span class='fu'><a href='FAData.html'>plotPed</a></span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='kw'>NULL</span>,
                                     <span class='kw'>filename</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>device</span><span class='kw'>=</span><span class='st'>"plot"</span>, <span class='no'>...</span>)

<span class='co'># S4 method for FAGenIndexResults</span>
<span class='fu'>plotRes</span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='kw'>NULL</span>,
                                     <span class='kw'>addLegend</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"density"</span>, <span class='no'>...</span>)

<span class='co'># S4 method for FAGenIndexResults</span>
<span class='fu'><a href='FAProbResults.html'>result</a></span>(<span class='no'>object</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"BH"</span>)

<span class='co'># S4 method for FAGenIndexResults</span>
<span class='fu'><a href='FAProbResults.html'>runSimulation</a></span>(<span class='no'>object</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>50000</span>,
                                           <span class='kw'>perFamilyTest</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
                                           <span class='kw'>controlSetMethod</span><span class='kw'>=</span><span class='st'>"getAll"</span>,
                                           <span class='kw'>rm.singletons</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>strata</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S4 method for FAGenIndexResults</span>
<span class='fu'><a href='FAData.html'>trait</a></span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>addLegend</th>
      <td><p>For <code>plotRes</code>: if a legend should be added to the plot.</p></td>
    </tr>
    <tr>
      <th>controlSetMethod</th>
      <td><p>For <code>runSimulation</code>: the method (i.e. name of the function)
    that should be used to define the set of (eventually matched)
    control individuals from which the random samples are
    taken. Supported functions are <code><a href='defineControls.html'>getAll</a></code>,
    <code><a href='defineControls.html'>getSexMatched</a></code> and
    <code><a href='defineControls.html'>getExternalMatched</a></code>. For <code>perFamilyTest=TRUE</code> also
    <code><a href='defineControls.html'>getGenerationMatched</a></code> and
    <code><a href='defineControls.html'>getGenerationSexMatched</a></code> are supported. Note: for
    <code>getExternalMatched</code>, a numeric, character or factor vector to
    be used for the matching has to be submitted to <code>runSimulation</code>
    as additional argument <code>match.using</code>.</p></td>
    </tr>
    <tr>
      <th>device</th>
      <td><p>For <code>plotPed</code>: see <code><a href='FAData.html'>plotPed</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>For <code>plotPed</code>: the family for which the pedigree should be
    plotted.
    For <code>plotRes</code>: the family for which the genealogical index
    analysis simulation results should be shown. Only supported if
    <code>perFamilyTest=TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>filename</th>
      <td><p>For <code>plotPed</code>: the file name to which the pedigree plot should
    be exported. See <code><a href='FAData.html'>plotPed</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>id</th>
      <td><p>For <code>plotPed</code>: the id of an indiviual from a family for which
    the pedigree should be plotted.
    For <code>plotRes</code>: the id of an individual from a family for which
    the genealogical index analysis simulation results should be
    shown. Only supported if <code>perFamilyTest=TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>The multiple hypothesis testing method. All methods supported by
    <code><a href='https://rdrr.io/r/stats/p.adjust.html'>p.adjust</a></code> are allowed.</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>Number of simulations.</p></td>
    </tr>
    <tr>
      <th>perFamilyTest</th>
      <td><p>For <code>runSimulation</code>: whether the test should be performed
    on the whole pedigree (default) or separately within each
    family. In the latter case the test evaluates the presence of
    clustered affected individuals within each family.</p></td>
    </tr>
    <tr>
      <th>rm.singletons</th>
      <td><p>For <code>runSimulation</code>: whether unconnected individuals in the
    pedigree (i.e. singletons) should be removed.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>The <code>FAGenIndexResults</code> object.</p></td>
    </tr>
    <tr>
      <th>strata</th>
      <td><p>For <code>runSimulation</code>: a numeric, character of factor
    characterizing each individual in the pedigree. The length of this
    vector and the ordering has to match the pedigree.
    This vector allows to perform stratified random sampling. See
    details or examples for more information.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>For <code>plotRes</code>: either <code>"density"</code> (the default) or
    <code>"hist"</code> specifying whether the distribution of expected values
    from the simulation should be visualized as a density plot or
    histogram.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>For <code>trait&lt;-</code>: can be a named numeric, character or factor
    vector. The names (at least some of them) have to match the ids in
    the pedigree of the object.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>For <code>plotPed</code>: additional arguments to be submitted to the
    internal <code>buildPed</code> call and to <code><a href='FAData.html'>plotPed</a></code>.</p>
<p>For <code>runSimulation</code>: additional arguments passed to the choosen
    <code>controlSetMethod</code> function (e.g. <code>match.using</code> for
    <code><a href='defineControls.html'>getExternalMatched</a></code>).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This implementation differs from the original method from Hill as it
  allows, in addition to perform per family analyses, to use also
  stratified sampling and allows a more flexible definition of the set
  of matched control individuals.
  The <code>controlSetMethod</code> parameter allows to specify a method to
  define the matched control set (e.g. matched by sex or matched by any
  externally provided vector).</p>
<p>Stratified sampling allows to even further fine tune the selection of
  matched controls. Assuming that in a pedigree the group of affected
  consists of 5 females and 3 male individuals, passing the sex of all
  individuals to the function (e.g. <code>strata=fad$sex</code>, with
  <code>fad</code> being the <code><a href='FAData.html'>FAData</a></code> object containing the
  pedigree to be analyzed) results in random sets with the same
  proportion of male/female individuals (i.e. 5 females, 3 males).</p>
<p>Note that, if <code>strata</code> is specified, all individuals with a
  missing value in <code>strata</code> (also affected individuals) are
  excluded from the analysis.</p>
<p>Note that by default singletons (i.e. unconnected individuals in
  the pedigree) are removed from the pedigree prior the
  analysis. Set <code>rm.singletons=FALSE</code> if you do not want them
  to be removed.</p>
<p>By default, the genealogical index is calculated on the whole
  pedigree, but it is also possible to evaluate within-family clustering
  of cases by specifying <code>perFamilyTest=TRUE</code>. In that case, it is
  also possible to use the <code><a href='defineControls.html'>getGenerationMatched</a></code> and
  <code><a href='defineControls.html'>getGenerationSexMatched</a></code> functions to define the set of
  matched controls from which random samples will be taken.</p>
<p>A call to the setter methods <code>trait&lt;-</code> resets any simulation
  results present in the <code>sim</code> slot, thus, the object can be
  re-used to perform a simulation analysis using the new trait data.</p>


    <h2 class="hasAnchor" id="objects-from-the-class"><a class="anchor" href="#objects-from-the-class"></a>Objects from the Class</h2>

    <p><code>FAGenIndexResults</code> objects are created calling the
  <code><a href='FAData-analysis.html'>genealogicalIndexTest</a></code> method on a
  <code><a href='FAData.html'>FAData</a></code> object.</p>
    <h2 class="hasAnchor" id="extends"><a class="anchor" href="#extends"></a>Extends</h2>

    <p>Class <code><a href='FAData.html'>FAData</a></code> directly.</p>
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    <p></p><dl>
    <dt>controlSetMethod</dt><dd><p>A character specifying the name of the method used to define the
      set of control individuals from which random samples were taken.</p></dd>
    <dt>nsim</dt><dd><p>Number of simulations.</p></dd>
    <dt>perFamilyTest</dt><dd><p>Logical indicating whether a per-family test was performed.</p></dd>
    <dt>sim</dt><dd><p>The result of the simulation. This slot should not be accessed
      directly, use the <code>result</code> method to extract result information.</p></dd>
  
</dl>

    <h2 class="hasAnchor" id="methods-and-functions"><a class="anchor" href="#methods-and-functions"></a>Methods and Functions</h2>

    <p></p><dl>

    plotPed
      Plots a pedigree for one of the affected individuals in the
      simulation results. The id of the selected affected individual
      (specified with argument <code>id</code>) is highlighted in red.
      See <code><a href='FAData.html'>plotPed</a></code> for more details.
    

    plotRes
      Plots the results from a genealogical index simulation
      analysis. The distribution of the mean kinship values of the
      randomly drawn controls are displayed as a grey density plot, the
      observed mean kinship value of all affected as a blue vertical
      line.
    

    <dt>result</dt><dd><p>Returns the result from the simulation as a <code>data.frame</code> with
      columns:
      <code>"trait_name"</code>: the name of the trait.
      <code>"total_phenotyped"</code>: total number of individuals in the
      pedigree phenotyped in the analyzed trait.
      <code>"total_affected"</code>: total number ofindividuals in the
      pedigree that are affected in the analyzed trait (i.e. number of
      cases).
      <code>"entity_id"</code>: the id for the analyzed entity, being either
      the whole pedigree (in which case the id will be <code>"1"</code>) or
      the id of the family (if <code>perFamilyTest=TRUE</code>).
      <code>"entity_ctrls"</code>: the number of (matched) control individuals
      from which the random samples were drawn.
      <code>"entity_affected"</code>: the number of affected individuals in
      the entity. This number can differ from the number of affected, if
      <code>strata</code> was specified and some of the affected have a
      missing value in <code>strata</code>.
      <code>"genealogical_index"</code>: the genealogical index of familiality
      (gif), i.e. the mean kinship value between all affected in the
      entity (pedigree or family). To be consistent with the original
      implementations, the genealogical index is the mean kinship
      multiplied with 100000.
      <code>"pvalue"</code>: the p-value for the significance of the mean
      kinship.
      <code>"padj"</code>: the p-value adjusted for multiple hypothesis
      testing (with the method specified with argument <code>method</code>).      The returned <code>data.frame</code> is sorted by column
      <code>"pvalue"</code>, its rownames correspond to column
      <code>"entity_id"</code>.</p></dd>

    <dt>runSimulation</dt><dd><p>Performs the simulation analysis based on the pedigree and trait
      information stored in the object. Returns a
      <code>FAGenIndexResults</code> object with the results of the simulation.</p></dd>

    <dt>trait&lt;-</dt><dd><p>Set the trait information. This method will reset all simulation
      results saved in the <code>sim</code> slot.</p></dd>

  
</dl>

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Subsetting (using the <code>[</code> operator) is not supported.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Refer to the method and function description above for detailed
  information on the returned result object.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Hill, J. R. (1980) A survey of cancer sites by kinship in the Utah Mormon
  population. In Cairns J, Lyon JL, Skolnick M (eds):
  <em>Cancer Incidence in Defined Populations. Banbury Report 4.</em>
  Cold Spring Harbor, NY: Cold Spring Harbor Laboratory Press, pp 299--318.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='FAData.html'>FAData</a></code>,
  <code><a href='FAData.html'>trait</a></code>,
  <code><a href='FAData-analysis.html'>probabilityTest</a></code>,
  <code><a href='FAData-analysis.html'>kinshipGroupTest</a></code>,
  <code><a href='FAData-analysis.html'>kinshipSumTest</a></code>,
  <code><a href='FAData-analysis.html'>familialIncidenceRateTest</a></code>,
  <code><a href='FAData-analysis.html'>fsirTest</a></code>,
  <code><a href='FAData.html'>plotPed</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>##########################</span>
<span class='co'>##</span>
<span class='co'>##  Perform the simulation analysis</span>
<span class='co'>##</span>
<span class='co'>## Load the Minnesota Breast Cancer data set.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>minnbreast</span>)

<span class='co'>## Subset to some families and generate a pedigree data.frame</span>
<span class='no'>mbsub</span> <span class='kw'>&lt;-</span> <span class='no'>minnbreast</span>[<span class='no'>minnbreast</span>$<span class='no'>famid</span> <span class='kw'>==</span> <span class='fl'>4</span> <span class='kw'>|</span> <span class='no'>minnbreast</span>$<span class='no'>famid</span> <span class='kw'>==</span> <span class='fl'>14</span> <span class='kw'>|</span>
                  <span class='no'>minnbreast</span>$<span class='no'>famid</span> <span class='kw'>==</span> <span class='fl'>6</span> <span class='kw'>|</span> <span class='no'>minnbreast</span>$<span class='no'>famid</span> <span class='kw'>==</span> <span class='fl'>8</span>, ]
<span class='no'>PedDf</span> <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>[, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"famid"</span>, <span class='st'>"id"</span>, <span class='st'>"fatherid"</span>, <span class='st'>"motherid"</span>, <span class='st'>"sex"</span>)]
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>PedDf</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"family"</span>, <span class='st'>"id"</span>, <span class='st'>"father"</span>, <span class='st'>"mother"</span>, <span class='st'>"sex"</span>)

<span class='co'>## Generate the FAData.</span>
<span class='no'>fad</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='FAData.html'>FAData</a></span>(<span class='kw'>pedigree</span><span class='kw'>=</span><span class='no'>PedDf</span>)</div><div class='output co'>#&gt; <span class='message'>Generating the kinship matrix...</span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'>
<span class='co'>## Specify the trait.</span>
<span class='no'>tcancer</span> <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>$<span class='no'>cancer</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>tcancer</span>) <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>$<span class='no'>id</span>

<span class='co'>## Perform the test with default settings, i.e. use all individuals</span>
<span class='co'>## in the pedigree as control set from which random samples are drawn</span>
<span class='co'>## and perform the analysis on the whole pedigree.</span>
<span class='no'>gi</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='FAData-analysis.html'>genealogicalIndexTest</a></span>(<span class='no'>fad</span>, <span class='kw'>trait</span><span class='kw'>=</span><span class='no'>tcancer</span>, <span class='kw'>traitName</span><span class='kw'>=</span><span class='st'>"cancer"</span>,
                            <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>1000</span>,)</div><div class='output co'>#&gt; <span class='message'>Removing singletons...</span></div><div class='output co'>#&gt; <span class='message'> 40 removed.</span></div><div class='output co'>#&gt; <span class='message'>Cleaning data set (got in total 154 individuals):</span></div><div class='output co'>#&gt; <span class='message'> * not phenotyped individuals among selected controls...</span></div><div class='output co'>#&gt; <span class='message'> 38 removed.</span></div><div class='output co'>#&gt; <span class='message'>Done</span></div><div class='input'><span class='co'>## Just show some information</span>
<span class='no'>gi</span></div><div class='output co'>#&gt; FAGenIndexResults object with:
#&gt;  * Pedigree of length 194.
#&gt;  * Number of unique individuals: 194.
#&gt;  * Number of families: 4.
#&gt;  * Number of individuals in largest family: 70.
#&gt;  * Number of individuals in smallest family: 40.
#&gt; Information on trait 'cancer'
#&gt;  * Number of non-NA values: 138.
#&gt;  * Number of non-zero values: 15.
#&gt; Result info:
#&gt;  * Dimension of result data.frame: 1.
#&gt;  * Number of simulations: 1000.
#&gt;  * Method for control set definition: getAll.
#&gt;  * Analysis performed for the whole pedigree.</div><div class='input'>
<span class='co'>## Show the results</span>
<span class='fu'><a href='FAProbResults.html'>result</a></span>(<span class='no'>gi</span>)</div><div class='output co'>#&gt;   trait_name total_phenotyped total_affected entity_id entity_ctrls
#&gt; 1     cancer              138             15         1          116
#&gt;   entity_affected genealogical_index pvalue  padj
#&gt; 1              13           4086.538  0.021 0.021</div><div class='input'>
<span class='co'>## Plot the observed mean kinship and the distribution of the mean kinship of</span>
<span class='co'>## random samples.</span>
<span class='fu'>plotRes</span>(<span class='no'>gi</span>)</div><div class='img'><img src='FAGenIndexResults-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Plot the pedigree for one of the families. All individuals</span>
<span class='co'>## used as matched control set are highlighted in red.</span>
<span class='fu'><a href='FAData.html'>plotPed</a></span>(<span class='no'>gi</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='st'>"8"</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: The genealogical index test has been performed on the full pedigree, but the plot was only generated for family 8!</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Not all probands specified in proband.id are in the pedigree!</span></div><div class='img'><img src='FAGenIndexResults-2.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; Did not plot the following people: 160 164 167 168 169 170 171 172 173 174 </div><div class='input'>
<span class='co'>## Repeat the analysis using the sex as strata. This will result in stratified</span>
<span class='co'>## random sampling with the number of female and male individuals selected in</span>
<span class='co'>## each permutation corresponding to the numbers below</span>
<span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span>(<span class='no'>gi</span>$<span class='no'>sex</span>[<span class='fu'><a href='FAData.html'>affectedIndividuals</a></span>(<span class='no'>gi</span>)])</div><div class='output co'>#&gt; 
#&gt;  M  F 
#&gt;  2 13 </div><div class='input'><span class='no'>giStrata</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='FAProbResults.html'>runSimulation</a></span>(<span class='no'>gi</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>1000</span>, <span class='kw'>strata</span><span class='kw'>=</span><span class='no'>gi</span>$<span class='no'>sex</span>)</div><div class='output co'>#&gt; <span class='message'>Removing singletons...</span></div><div class='output co'>#&gt; <span class='message'> 40 removed.</span></div><div class='output co'>#&gt; <span class='message'>Cleaning data set (got in total 154 individuals):</span></div><div class='output co'>#&gt; <span class='message'> * affected individuals without valid strata values...</span></div><div class='output co'>#&gt; <span class='message'> none present.</span></div><div class='output co'>#&gt; <span class='message'> * not phenotyped individuals among selected controls...</span></div><div class='output co'>#&gt; <span class='message'> 38 removed.</span></div><div class='output co'>#&gt; <span class='message'> * control individuals without valid strata values...</span></div><div class='output co'>#&gt; <span class='message'> 3 removed.</span></div><div class='output co'>#&gt; <span class='message'>Done</span></div><div class='input'><span class='fu'><a href='FAProbResults.html'>result</a></span>(<span class='no'>giStrata</span>)</div><div class='output co'>#&gt;   trait_name total_phenotyped total_affected entity_id entity_ctrls
#&gt; 1     cancer              138             15         1          113
#&gt;   entity_affected genealogical_index pvalue  padj
#&gt; 1              13           4086.538  0.032 0.032</div><div class='input'>

<span class='co'>## Alternatively, we can use "getSexMatched" as the function to define the set</span>
<span class='co'>## of control individuals. Just, in the present case both male and females</span>
<span class='co'>## individuals will be selected since also there are male and female individuals</span>
<span class='co'>## among the affected cases.</span>
<span class='no'>giPerFam</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='FAProbResults.html'>runSimulation</a></span>(<span class='no'>gi</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>1000</span>, <span class='kw'>controlSetMethod</span><span class='kw'>=</span><span class='st'>"getSexMatched"</span>,
                          <span class='kw'>perFamilyTest</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='message'>Removing singletons...</span></div><div class='output co'>#&gt; <span class='message'> 40 removed.</span></div><div class='output co'>#&gt; <span class='message'>Cleaning data set (got in total 29 individuals):</span></div><div class='output co'>#&gt; <span class='message'> * not phenotyped individuals among selected controls...</span></div><div class='output co'>#&gt; <span class='message'> none present.</span></div><div class='output co'>#&gt; <span class='message'>Done</span></div><div class='output co'>#&gt; <span class='message'>Cleaning data set (got in total 33 individuals):</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Can not perform test for family 6: less than 2 affected individuals in the trait.</span></div><div class='output co'>#&gt; <span class='message'>Cleaning data set (got in total 30 individuals):</span></div><div class='output co'>#&gt; <span class='message'> * not phenotyped individuals among selected controls...</span></div><div class='output co'>#&gt; <span class='message'> 1 removed.</span></div><div class='output co'>#&gt; <span class='message'>Done</span></div><div class='output co'>#&gt; <span class='message'>Cleaning data set (got in total 62 individuals):</span></div><div class='output co'>#&gt; <span class='message'> * not phenotyped individuals among selected controls...</span></div><div class='output co'>#&gt; <span class='message'> 3 removed.</span></div><div class='output co'>#&gt; <span class='message'>Done</span></div><div class='output co'>#&gt; <span class='warning'>Warning: The proportion of affected individuals among the matched controls is &gt; 25% in family 14.</span></div><div class='input'><span class='fu'><a href='FAProbResults.html'>result</a></span>(<span class='no'>giPerFam</span>)</div><div class='output co'>#&gt;    trait_name total_phenotyped total_affected entity_id entity_ctrls
#&gt; 14     cancer              138             15        14           14
#&gt; 4      cancer              138             15         4           29
#&gt; 8      cancer              138             15         8           29
#&gt; 6      cancer              138             15         6            1
#&gt;    entity_affected genealogical_index pvalue  padj
#&gt; 14               5              21250  0.018 0.054
#&gt; 4                2              12500  0.396 0.490
#&gt; 8                5               9375  0.490 0.490
#&gt; 6                1                 NA     NA    NA</div><div class='input'>
<span class='co'>## For those families in which there are only female cases, random samples</span>
<span class='co'>## were drawn among only female individuals (within the same family). These</span>
<span class='co'>## are highlighted in red in the pedigree plot:</span>
<span class='fu'><a href='FAData.html'>plotPed</a></span>(<span class='no'>giPerFam</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='st'>"14"</span>, <span class='kw'>cex</span><span class='kw'>=</span><span class='fl'>0.5</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: More than 25% of the gender values are 'unknown'</span></div><div class='img'><img src='FAGenIndexResults-3.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; Did not plot the following people: 457 463 470 471 26067 26068 26098 26099 </div><div class='input'>
<span class='co'>## Plot the simulation result for this family:</span>
<span class='fu'>plotRes</span>(<span class='no'>giPerFam</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='st'>"14"</span>)</div><div class='img'><img src='FAGenIndexResults-4.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Johannes Rainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


