<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>DEPRECATED: Probability test — FAProbResults-class • FamAgg</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="DEPRECATED: Probability test — FAProbResults-class" />
<meta property="og:description" content="The FAProbResults object contains the results from the
  probability test.
  The probability test is only a convience method that calls the gap package's
  method pfc.sim to compute probabilities of familial clustering
  of phenotypes [Yu and Zelterman (2002)]. One drawback of that method
  is that it is limited to families with at most 22 individuals. Thus,
  pedigrees need to be split with specialized software such as Jenti
  [Falchi and Fuchsberger ea. (2008)], which within large families
  define cliques that can then be used as input to this algorithm.
DEPRECATION WARNING:  
Due to problems of the gap package on MS Windows systems, this
  test will be removed in the next Bioconductor release (3.8)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FamAgg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.17.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/FamAgg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/EuracBiomedicalResearch/FamAgg/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>DEPRECATED: Probability test</h1>
    
    <div class="hidden name"><code>FAProbResults.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>FAProbResults</code> object contains the results from the
  <em>probability test</em>.
  The probability test is only a convience method that calls the <code>gap</code> package's
  method <code>pfc.sim</code> to compute probabilities of familial clustering
  of phenotypes [Yu and Zelterman (2002)]. One drawback of that method
  is that it is limited to families with at most 22 individuals. Thus,
  pedigrees need to be split with specialized software such as Jenti
  [Falchi and Fuchsberger ea. (2008)], which within large families
  define cliques that can then be used as input to this algorithm.</p>
<p><em>DEPRECATION WARNING:</em></p>  
<p>Due to problems of the <code>gap</code> package on MS Windows systems, this
  test will be removed in the next Bioconductor release (3.8).</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for FAProbResults</span>
<span class='fu'><a href='FAData.html'>buildPed</a></span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>max.generations.up</span><span class='kw'>=</span><span class='fl'>3</span>,
                                  <span class='kw'>max.generations.down</span><span class='kw'>=</span><span class='fl'>16</span>, <span class='kw'>prune</span><span class='kw'>=</span><span class='fl'>FALSE</span>)

<span class='co'># S4 method for FAProbResults</span>
<span class='fu'>cliqueAndTrait</span>(<span class='no'>object</span>, <span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>FALSE</span>)

<span class='co'># S4 method for FAProbResults</span>
<span class='fu'>cliques</span>(<span class='no'>object</span>, <span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>FALSE</span>)

<span class='co'># S4 method for FAProbResults</span>
<span class='fu'>cliques</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for FAProbResults</span>
<span class='fu'><a href='FAData.html'>plotPed</a></span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='kw'>NULL</span>,
                                 <span class='kw'>filename</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>device</span><span class='kw'>=</span><span class='st'>"plot"</span>, <span class='no'>...</span>)

<span class='co'># S4 method for FAProbResults</span>
<span class='fu'>result</span>(<span class='no'>object</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"BH"</span>)

<span class='co'># S4 method for FAProbResults</span>
<span class='fu'>runSimulation</span>(<span class='no'>object</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>50000</span>)

<span class='co'># S4 method for FAProbResults</span>
<span class='fu'><a href='Pedigree-utils.html'>shareKinship</a></span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>)

<span class='co'># S4 method for FAProbResults</span>
<span class='fu'><a href='FAData.html'>trait</a></span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for FAProbResults</span>
<span class='fu'>traitByClique</span>(<span class='no'>object</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>device</th>
      <td><p>For <code>plotPed</code>: see <code><a href='FAData.html'>plotPed</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>For <code>plotPed</code>: not supported.</p></td>
    </tr>
    <tr>
      <th>filename</th>
      <td><p>For <code>plotPed</code>: the file name to which the pedigree plot should
    be exported. See <code><a href='FAData.html'>plotPed</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>id</th>
      <td><p>For <code>buildPed</code>, <code>plotPed</code>, <code>shareKinship</code>: the id
    (character or numerif) of the clique (i.e. one of the ids in column
    <code>"group_id"</code> of the result table <code>result(object)</code>).</p>
<p>Note: <code>id</code> can be a <code>numeric</code> or a
    <code>character</code>. Numeric ids will be internally converted to
    <code>character</code>.</p></td>
    </tr>
    <tr>
      <th>max.generations.down</th>
      <td><p>For <code>buildPed</code>: the maximal number of generations to look for
    children.</p></td>
    </tr>
    <tr>
      <th>max.generations.up</th>
      <td><p>For <code>buildPed</code>: the maximal number of generations to look for
    ancestors.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>The multiple hypothesis testing method. All methods supported by
    <code><a href='https://rdrr.io/r/stats/p.adjust.html'>p.adjust</a></code> are allowed.</p></td>
    </tr>
    <tr>
      <th>na.rm</th>
      <td><p>Whether <code>NA</code> elements should be returned or not.</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>Number of simulations.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>The <code>FAProbResults</code> object.</p></td>
    </tr>
    <tr>
      <th>prune</th>
      <td><p>For <code>buildPed</code>: whether the full pedigree should be returned
    (<code>prune=FALSE</code>) or the pedigree should be reduced to the
    individuals in the corresponding clique (<code>prune=TRUE</code>). Note: the
    <code>plotPed</code> method does also support this parameter.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>For <code>cliques&lt;-</code>: can be a named numeric, character or factor
    vector. The names (at least some of them) have to match the ids in
    the pedigree of the object.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>For <code>plotPed</code>: additional arguments to be submitted to the
    internal <code>buildPed</code> call and to <code><a href='FAData.html'>plotPed</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="objects-from-the-class"><a class="anchor" href="#objects-from-the-class"></a>Objects from the Class</h2>

    <p><code>FAProbResults</code> objects are created by the
  <code><a href='FAData-analysis.html'>probabilityTest</a></code> method of <code><a href='FAData.html'>FAData</a></code>
  objects.</p>
    <h2 class="hasAnchor" id="extends"><a class="anchor" href="#extends"></a>Extends</h2>

    <p>Class <code><a href='FAData.html'>FAData</a></code> directly.</p>
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    <p></p><dl>
    <dt>nsim</dt><dd><p>Number of simulations.</p></dd>

    <dt>sim</dt><dd><p>The result of the simulation. This slot should not be directly
      accessed, use the <code>result</code> method to extract result information.</p></dd>

    <dt>.cliques</dt><dd><p>A factor with the assignment of individuals to cliques. This slot
      should not be accessed directly, but the <code>cliques</code> and
      <code>cliques&lt;-</code> methods should be used instead that ensure that
      the data is matched to the information in the pedigree.</p></dd>

  
</dl>

    <h2 class="hasAnchor" id="methods-and-functions"><a class="anchor" href="#methods-and-functions"></a>Methods and Functions</h2>

    <p></p><dl>

    <dt>cliqueAndTrait</dt><dd><p>Get a <code>data.frame</code> with the clique ID and the value from the
      trait for each individual. If <code>na.rm=TRUE</code> all rows
      (individuals) with either a missing clique ID or trait value are
      removed.</p></dd>

    <dt>buildPed</dt><dd><p>Builds the pedigree for the submitted id (which represents the id
      of the group, i.e. the clique (e.g. column <code>"group_id"</code> of
      <code>result(object)</code>). By default the method builds the full
      pedigree for all individuals in the clique but the argument
      <code>prune</code> allows to reduce it to the individuals of the clique.
      Building a pedigree by submitting the family id is not supported.
      The pedigree is returned as a <code>data.frame</code>.</p></dd>

    <dt>cliques</dt><dd><p>Returns a <code>factor</code> vector representing the clique/group
      assignment of the individuals. By default, the ordering
      is the same as pedigree, setting argument <code>na.rm=TRUE</code>
      removes all <code>NA</code> values, thus the ordering and length might
      differ (e.g. if some individuals are not part of any clique).</p></dd>

    <dt>cliques&lt;-</dt><dd><p>Setter for the cliques vector. Can be a named numeric vector, character
      vector or factor with the names matching the ids of the
      individuals in the pedigree. The method internally matches and
      re-orders the cliques vector to match the ordering of the ids in
      the pedigree.
      In addition, the function resets eventually stored simulation
      results in the <code>sim</code> slot.</p></dd>

    plotPed
      Plots a pedigree for one of the cliques in the
      simulation results. The ids of all individuals of the selected
      clique are highlighted in red.
      See <code><a href='FAData.html'>plotPed</a></code> for more details on
      the plotting and details below for additional settings.
    

    <dt>result</dt><dd><p>Returns the result from the simulation as a <code>data.frame</code> with
      columns:
      <code>trait_name</code>: the name of the trait.
      <code>total_phenotyped</code>: the total number of phenotyped
      individuals in the trait.
      <code>total_affected</code>: the total number of affected individuals in
      the trait.
      <code>phenotyped</code>: the number of phenotyped individuals in
      all group (i.e. cliques specified by the <code>clique</code> parameter).
      <code>affected</code>: the number of affected individuals in
      all group (i.e. cliques specified by the <code>clique</code> parameter).
      <code>group_id</code>: the id of the group (clique).
      <code>family</code>: the id of the family in which the clique was defined.
      <code>group_phenotyped</code>: the number of phenotyped individuals in the
      current group.
      <code>group_affected</code>: the number of affected individuals in the current
      group.
      <code>pvalue</code>: the p-value from the Monte Carlo simulation.
      <code>padj</code>: the p-value adjusted for multiple hypothesis testing
      using the method specified with argument <code>method</code>.</p></dd>

    <dt>runSimulation</dt><dd><p>Performs the simulation analysis based on the pedigree, trait and
      clique information stored in the object. Returns a
      <code>FAProbResults</code> object with the results of the simulation.</p></dd>

    <dt>shareKinship</dt><dd><p>Returns a character vector with the ids of all individuals that
      share kinship with any of the individuals in the clique identified
      by the argument <code>id</code>.</p></dd>

    <dt>trait&lt;-</dt><dd><p>Set the trait information. This method will reset all simulation
      results saved in the <code>sim</code> slot.</p></dd>

    <dt>traitByClique</dt><dd><p>Summarize the trait information by clique. Returns a <code>matrix</code>
      with the size of the clique (i.e. individuals in the clique with
      available trait information) and count of individuals in the
      clique with a trait value other than zero (column
      <code>affected_size</code>). The clique ids are used as rownames of the
      <code>matrix</code>.</p></dd>
  
</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Calling the <code>runSimulation</code> method on a <code>FAProbResults</code>
  object is the same as calling the <code>probabilityTest</code> on a
  <code><a href='FAData.html'>FAData</a></code> object. In the first case the
  simulation is performed using the clique and trait information
  data stored internally in the object, while in the latter case the
  clique and trait information have to be submitted to the function
  call.</p>
<p>A call to the setter methods <code>trait&lt;-</code> or <code>cliques&lt;-</code> resets
  any simulation results present in the <code>sim</code> slot, thus, the
  object can be re-used to perform a simulation analysis using the new
  trait or clique data.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Subsetting (using the <code>[</code> operator) is not supported.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Refer to the method and function description above for detailed
  information on the returned result object.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Yu C &amp; Zelterman D (2002) Statistical inference for familial disease
  clusters. <em>Biometrics</em>, pp 481-491</p>
<p>Falchi M &amp; Fuchsberger C (2008) Jenti: an efficient tool for mining
  complex inbred genealogies. <em>Bioinformatics</em>, pp 724-726</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='FAData.html'>FAData</a></code>,
  <code><a href='FAData.html'>buildPed</a></code>,
  <code><a href='FAData.html'>plotPed</a></code>,
  <code><a href='FAData.html'>trait</a></code>,
  <code><a href='FAData-analysis.html'>probabilityTest</a></code>,
  <code><a href='FAData-analysis.html'>kinshipGroupTest</a></code>,
  <code><a href='FAData-analysis.html'>kinshipSumTest</a></code>,
  <code><a href='FAData-analysis.html'>genealogicalIndexTest</a></code>,
  <code><a href='FAData-analysis.html'>familialIncidenceRateTest</a></code>,
  <code><a href='FAData-analysis.html'>fsirTest</a></code></p></div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Johannes Rainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


