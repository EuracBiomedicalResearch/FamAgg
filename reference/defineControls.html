<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Define sets of control individuals for one or more given individuals — getAll • FamAgg</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Define sets of control individuals for one or more given individuals — getAll" />
<meta property="og:description" content="These functions allow to define sets of (eventually matched) control
  individuals for one or more given individuals using pedigree data. By
  default, controls from the same family than the specified
  individual(s) are returned.
  They are used e.g. in the genealogicalIndexTest method." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FamAgg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.17.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/FamAgg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/EuracBiomedicalResearch/FamAgg/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Define sets of control individuals for one or more given individuals</h1>
    
    <div class="hidden name"><code>defineControls.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>These functions allow to define sets of (eventually matched) control
  individuals for one or more given individuals using pedigree data. By
  default, controls from the same family than the specified
  individual(s) are returned.
  They are used e.g. in the <code><a href='FAData-analysis.html'>genealogicalIndexTest</a></code> method.</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for data.frame</span>
<span class='fu'>getAll</span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S4 method for data.frame</span>
<span class='fu'>getExternalMatched</span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>match.using</span>, <span class='no'>...</span>)

<span class='co'># S4 method for data.frame</span>
<span class='fu'>getGenerationMatched</span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>,
                                           <span class='kw'>include.anc</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>include.off</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='no'>...</span>)

<span class='co'># S4 method for data.frame</span>
<span class='fu'>getGenerationSexMatched</span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>,
                                               <span class='kw'>include.anc</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>include.off</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='no'>...</span>)

<span class='co'># S4 method for data.frame</span>
<span class='fu'>getSexMatched</span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>id</th>
      <td><p>A character vector with ids of individuals for whom matched
    control individuals (from the same family) should be defined.</p></td>
    </tr>
    <tr>
      <th>include.anc</th>
      <td><p>For <code>getGenerationMatched</code> and <code>getGenerationSexMatched</code>:
    number of ancestor generations of individuals <code>id</code> in which
    control individuals should be defined, in addition to the actual
    generation of the individuals <code>id</code>.
    By default the functions define control individuals only in the
    actual generation of the individuals in <code>id</code>.</p></td>
    </tr>
    <tr>
      <th>include.off</th>
      <td><p>For <code>getGenerationMatched</code> and <code>getGenerationSexMatched</code>:
    number of offspring generations of individuals <code>id</code> in which
    control individuals should be defined, in addition to the actual
    generation of the individuals <code>id</code>.
    By default the functions define control individuals only in the
    actual generation of the individuals in <code>id</code>.</p></td>
    </tr>
    <tr>
      <th>match.using</th>
      <td><p>For <code>getExternalMatched</code>: a named vector for matching of
    controls. The names of the vector have to correspond to the ids of
    the individuals in the pedigree (but can have a different ordering).</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>Either a <code>data.frame</code>, <code>pedigree</code> or a <code>pedigreeList</code>
    object specifying the pedigree. If a <code>data.frame</code> is submitted,
    the columns <code>id</code>, <code>family</code>, <code>father</code>, <code>mother</code> and
    <code>sex</code> are required.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments; not used at present.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="get-matched-controls"><a class="anchor" href="#get-matched-controls"></a>Get matched controls</h2>

    

<p></p><dl>

    <dt>getAll</dt><dd><p>Simply returns the ids of all individuals in the family
      (i.e. individuals with the same family id in the pedigree) of the
      specified ids in <code>id</code>.
      Returns a list with the ids (of type <code>character</code>) of the
      controls. The names of the list correspond to the family id.</p></dd>

    <dt>getExternalMatched</dt><dd><p>Returns the ids of matched individuals from the same family for
      the specified ids in <code>id</code>.
      The <code>match.using</code> vector is for the matching, i.e. the
      function first extracts the values for the individuals in
      <code>id</code> from <code>match.using</code> and returns the ids of all
      individuals whose value in <code>match.using</code> matches the value of
      the individuals specified by <code>id</code>. Individuals with a missing
      value in <code>match.using</code> are excluded.
      Returns a list with the ids (of type <code>character</code>) of the
      controls. The names of the list correspond to the family id.</p></dd>

    <dt>getGenerationMatched</dt><dd><p>Returns the ids of individuals matched by the generation of the
      individuals in <code>id</code>. The function returns the ids of all
      individuals from the same generation(s) than the individuals in
      <code>id</code>. The arguments <code>include.anc</code> and <code>include.off</code>
      can be used to increase the range of generation from which
      individuals are selected.
      Returns a list with the ids (of type <code>character</code>) of the
      controls. The names of the list correspond to the family id.</p></dd>

    <dt>getGenerationSexMatched</dt><dd><p>Same as <code>getGenerationMatched</code>, but matches in addition
      individuals by sex (see <code>getSexMatched</code>).
      Returns a list with the ids (of type <code>character</code>) of the
      controls. The names of the list correspond to the family id.</p></dd>

    <dt>getSexMatched</dt><dd><p>Returns ids of individuals from the same family matching the sex
      of the individuals in <code>id</code>. Individuals with sex being
      <code>NA</code> are excluded. The result is essentially identical to the
      <code>getAll</code> if <code>id</code> contains ids of male and female
      individuals.
      Returns a list with the ids (of type <code>character</code>) of the
      controls. The names of the list correspond to the family id.</p></dd>

  
</dl>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Refer to the method and function description above for detailed
  information on the returned result object.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/kinship2/man/pedigree.html'>pedigree</a></code>,
  <code><a href='FAData.html'>FAData</a></code>,
  <code><a href='FAProbResults.html'>FAProbResults</a></code>,
  <code><a href='FAKinGroupResults.html'>FAKinGroupResults</a></code>,
  <code><a href='FAKinSumResults.html'>FAKinSumResults</a></code>,
  <code><a href='FAGenIndexResults.html'>FAGenIndexResults</a></code>,
  <code><a href='FAData-analysis.html'>genealogicalIndexTest</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>##########################</span>
<span class='co'>##</span>
<span class='co'>##  Defining a small pedigree</span>
<span class='co'>##</span>
<span class='co'>## load the Minnesota Breast Cancer record and subset to the</span>
<span class='co'>## first families.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>minnbreast</span>)
<span class='no'>mbsub</span> <span class='kw'>&lt;-</span> <span class='no'>minnbreast</span>[<span class='no'>minnbreast</span>$<span class='no'>famid</span><span class='kw'>==</span><span class='fl'>4</span> <span class='kw'>|</span> <span class='no'>minnbreast</span>$<span class='no'>famid</span><span class='kw'>==</span><span class='fl'>5</span>, ]
<span class='no'>mbped</span> <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>[, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"famid"</span>, <span class='st'>"id"</span>, <span class='st'>"fatherid"</span>, <span class='st'>"motherid"</span>, <span class='st'>"sex"</span>)]
<span class='co'>## renaming column names</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>mbped</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"family"</span>, <span class='st'>"id"</span>, <span class='st'>"father"</span>, <span class='st'>"mother"</span>, <span class='st'>"sex"</span>)

<span class='co'>## Get ids of individuals from the same generation than "4"</span>
<span class='fu'>getGenerationMatched</span>(<span class='no'>mbped</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='st'>"4"</span>)</div><div class='output co'>#&gt; $`4`
#&gt;  [1] "4"  "5"  "6"  "7"  "8"  "9"  "10" "25" "26" "27" "28" "29"
#&gt; </div><div class='input'>
<span class='co'>## Get the ids of gemale individuals from the same generation than</span>
<span class='co'>## "4" and "22"</span>
<span class='fu'>getGenerationSexMatched</span>(<span class='no'>mbped</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"4"</span>, <span class='st'>"22"</span>))</div><div class='output co'>#&gt; $`4`
#&gt; [1] "4"  "8"  "9"  "10" "22" "23" "26" "27"
#&gt; </div><div class='input'>
<span class='co'>## Generate a FAData</span>
<span class='no'>fad</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='FAData.html'>FAData</a></span>(<span class='no'>mbped</span>)</div><div class='output co'>#&gt; <span class='message'>Generating the kinship matrix...</span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'>
<span class='co'>## Plot the pedigree so we can evaluate the results of the function</span>
<span class='fu'><a href='FAData.html'>plotPed</a></span>(<span class='no'>fad</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='st'>"4"</span>)</div><div class='img'><img src='defineControls-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; Did not plot the following people: 30 31 32 33 34 35 36 37 38 39 40 41 42 43 </div><div class='input'>
<span class='co'>## We're using getExternalMatched on the sex of the individuals</span>
<span class='co'>## in the pedigree, thus the results are identical to the</span>
<span class='co'>## getSexMatched function.</span>
<span class='co'>## Extracting the sex using $sex returns a named vector just</span>
<span class='co'>## as we need for getExternalMatched.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>fad</span>$<span class='no'>sex</span>)</div><div class='output co'>#&gt; 1 2 3 4 5 6 
#&gt; M F F F M M 
#&gt; Levels: M F</div><div class='input'><span class='fu'>getExternalMatched</span>(<span class='no'>fad</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='st'>"4"</span>, <span class='kw'>match.using</span><span class='kw'>=</span><span class='no'>fad</span>$<span class='no'>sex</span>)</div><div class='output co'>#&gt; $`4`
#&gt;  [1] "2"  "3"  "4"  "8"  "9"  "10" "12" "13" "16" "19" "20" "22" "23" "26" "27"
#&gt; [16] "31" "34" "35" "37" "40" "43"
#&gt; </div><div class='input'>
<span class='fu'>getSexMatched</span>(<span class='no'>fad</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='st'>"4"</span>)</div><div class='output co'>#&gt; $`4`
#&gt;  [1] "2"  "3"  "4"  "8"  "9"  "10" "12" "13" "16" "19" "20" "22" "23" "26" "27"
#&gt; [16] "31" "34" "35" "37" "40" "43"
#&gt; </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Johannes Rainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


