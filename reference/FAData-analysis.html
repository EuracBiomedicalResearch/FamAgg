<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Pedigree analysis and familial aggregation methods — PedigreeAnalysis • FamAgg</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Pedigree analysis and familial aggregation methods — PedigreeAnalysis" />
<meta property="og:description" content="Various functions to perform pedigree analyses and to investigate
  familial clustering of e.g. cancer cases." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FamAgg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.17.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/FamAgg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/EuracBiomedicalResearch/FamAgg/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Pedigree analysis and familial aggregation methods</h1>
    
    <div class="hidden name"><code>FAData-analysis.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Various functions to perform pedigree analyses and to investigate
  familial clustering of e.g. cancer cases.</p>
    </div>

    <pre class="usage">binomialTest(object, trait, traitName, global = FALSE, prob = NULL,
    alternative = c("greater", "less", "two.sided"))

estimateTimeAtRisk(startDate=NULL, startDateFormat="%Y-%m-%d",
                   endDate=NULL, endDateFormat="%Y-%m-%d",
                   incidenceDate=NULL, incidenceDateFormat="%Y-%m-%d",
                   deathDate=NULL, deathDateFormat="%Y-%m-%d",
                   allowNegative=FALSE, affected=NULL,
                   incidenceSubtract=0.5)

factor2matrix(x)

# S4 method for FAData
familialIncidenceRate(object, trait=NULL,
                                         timeAtRisk=NULL)

# S4 method for FAData
familialIncidenceRateTest(object, trait=NULL,
                                            nsim=50000, traitName=NULL,
                                            timeAtRisk=NULL,
                                            strata=NULL, ...)

# S4 method for FAData
fsir(object, trait=NULL, lambda=NULL, timeInStrata=NULL)

# S4 method for FAData
fsirTest(object, trait=NULL, nsim=50000, traitName=NULL,
                            lambda=NULL, timeInStrata=NULL,
                            strata=NULL, ...)

# S4 method for FAData
genealogicalIndexTest(object, trait, nsim=50000,
                                         traitName, perFamilyTest=FALSE,
                                         controlSetMethod="getAll",
                                         rm.singletons=TRUE, strata=NULL, ...)

# S4 method for FAData
kinshipGroupTest(object, trait, nsim=50000,
                                    traitName, strata=NULL, ...)

# S4 method for FAData
kinshipSumTest(object, trait, nsim=50000,
                                  traitName, strata=NULL, ...)

# S4 method for FAData
probabilityTest(object, trait, cliques,
                                   nsim=50000, traitName,
                                   ...)

sliceAge(x, slices=c(0, 40, Inf))
&lt;!-- %connectedSubgraph(graph, nodes, mode="all", all.nodes=TRUE, ifnotfound) --&gt;</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>affected</th>
      <td><p>For <code>estimateTimeAtRisk</code>: optional parameter specifying which
    of the individuals are affected. This is useful if only <code>endDate</code> is
    specified, but not the <code>incidenceDate</code>. See method description
    for further details.</p></td>
    </tr>
    <tr>
      <th>allowNegative</th>
      <td><p>For <code>estimateTimeAtRisk</code>: if <code>FALSE</code> any negative time
    periods are set to <code>0</code>.</p></td>
    </tr>
    <tr>
      <th>alternative</th>
      <td><p>For <code>binomialTest</code>: the alternative hypothesis. See
    <code><a href='https://rdrr.io/r/stats/binom.test.html'>binom.test</a></code> for more details. Defaults to
    <code>"greater"</code>, i.e. tests whether in a family a larger number of
    affected is present than expected by chance (given a global
    probability).</p></td>
    </tr>
    <tr>
      <th>cliques</th>
      <td><p>A named numeric or characted vector or factor with the names
    corresponding to ids of the individuals in the pedigree. The ids
    will be internally matched and sub-set to the ids available in the
    pedigree.</p></td>
    </tr>
    <tr>
      <th>controlSetMethod</th>
      <td><p>For <code>genealogicalIndexTest</code>: the method (i.e. name of the function)
    that should be used to define the set of (eventually matched)
    control individuals from which the random samples are
    taken. Supported functions are <code><a href='defineControls.html'>getAll</a></code>,
    <code><a href='defineControls.html'>getSexMatched</a></code> and
    <code><a href='defineControls.html'>getExternalMatched</a></code>. For <code>perFamilyTest=TRUE</code> also
    <code><a href='defineControls.html'>getGenerationMatched</a></code> and
    <code><a href='defineControls.html'>getGenerationSexMatched</a></code> are supported.
    Note: for <code>getExternalMatched</code>, a numeric, character or factor vector to
    be used for the matching has to be submitted
    as additional argument <code>match.using</code>.</p></td>
    </tr>
    <tr>
      <th>deathDate</th>
      <td><p>For <code>estimateTimeAtRisk</code>: the date of death.</p></td>
    </tr>
    <tr>
      <th>deathDateFormat</th>
      <td><p>For <code>estimateTimeAtRisk</code>: the format in which the dates are
    submitted. See <code><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></code> for more information.</p></td>
    </tr>
    <tr>
      <th>endDate</th>
      <td><p>For <code>estimateTimeAtRisk</code>: the end date, which can be the end
    date for the study or, if <code>deathDate</code> and <code>incidenceDate</code>
    are not specified, the earliest time point of: date of incidence,
    death or end of study.</p></td>
    </tr>
    <tr>
      <th>endDateFormat</th>
      <td><p>For <code>estimateTimeAtRisk</code>: the format in which the dates are
    submitted. See <code><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></code> for more information.</p></td>
    </tr>
    <tr>
      <th>global</th>
      <td><p>For <code>binomialTest</code>: whether the binomial test should be applied
    to the whole pedigree, or family-wise (default). If
    <code>global = TRUE</code> the population probability has to be provided
    with parameter <code>prob</code>.</p></td>
    </tr>
    <tr>
      <th>incidenceDate</th>
      <td><p>For <code>estimateTimeAtRisk</code>: the date of the incidence for an
    individual, i.e. the date when the status was changed from
    un-affected to affected in the to be analyzed trait.</p></td>
    </tr>
    <tr>
      <th>incidenceDateFormat</th>
      <td><p>For <code>estimateTimeAtRisk</code>: the format in which the dates are
    submitted. See <code><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></code> for more information.</p></td>
    </tr>
    <tr>
      <th>incidenceSubtract</th>
      <td><p>For <code>estimateTimeAtRisk</code>: the amount of time (of the time unit
    of the time at risk) that should be
    subtracted from the calculated time at risk for affected
    individuals. See method description below for more details.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>Numeric vector with the incidence rates per stratum from the
    population. The length of this vector has to match the number of
    columns of argument <code>timeInStrata</code>.</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>The number of simulations.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>The <code>FAData</code> object.</p></td>
    </tr>
    <tr>
      <th>perFamilyTest</th>
      <td><p>For <code>genealogicalIndexTest</code>: whether the test should be performed
    on the whole pedigree (default) or separately within each
    family. In the latter case the test evaluates the presence of
    clustered affected individuals within each family.</p></td>
    </tr>
    <tr>
      <th>prob</th>
      <td><p>For <code>binomialTest</code>: the hypothesized probability of success
    (being affected) from/for the whole population.</p></td>
    </tr>
    <tr>
      <th>rm.singletons</th>
      <td><p>For <code>genealogicalIndexTest</code>:
    whether unconnected individuals in the pedigree (singletons) should
    be removed from the pedigree prior to the analysis.</p></td>
    </tr>
    <tr>
      <th>slices</th>
      <td><p>For <code>sliceAge</code>: a numeric vector defining the
    age-slices. Similar to argument <code>vec</code> for
    <code><a href='https://rdrr.io/r/base/findInterval.html'>findInterval</a></code>. Defines the minimum and maximum age for
    the age slices, i.e. first number corresponds to the lower boundary
    of the first age slice, the second number to the upper boundary of
    the first and lower boundary of the second age slice and so on.</p></td>
    </tr>
    <tr>
      <th>startDate</th>
      <td><p>For <code>estimateTimeAtRisk</code>: the date of the start of the
    study. Can also be the birth date.</p></td>
    </tr>
    <tr>
      <th>startDateFormat</th>
      <td><p>For <code>estimateTimeAtRisk</code>: the format in which the dates are
    submitted. See <code><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></code> for more information.</p></td>
    </tr>
    <tr>
      <th>strata</th>
      <td><p>For <code>genealogicalIndexTest</code>, <code>kinshipGroupTest</code> and
    <code>kinshipSumTest</code>: a numeric, character or factor
    characterizing each individual in the pedigree. The length of this
    vector and the ordering has to match the pedigree.
    This vector allows to perform stratified random sampling. See
    details for more information.</p></td>
    </tr>
    <tr>
      <th>timeAtRisk</th>
      <td><p>A numeric vector specifying the <em>time at risk</em> for each
    individual. The definition for this variable is taken from Kerber
    (1995). See description of the method below for more information.
    <code>timeAtRisk</code> has to have the same number of elements than there are
    individuals in the pedigree and it is assumed that the ordering of
    the vector matches the order of the individuals in the pedigree.</p></td>
    </tr>
    <tr>
      <th>timeInStrata</th>
      <td><p>For <code>fsir</code> and <code>fsirTest</code>: a numeric matrix specifying the time at
    risk for each individual in each strata. Columns represent the
    strata, rows the individuals, each cell the time at risk for the
    individual in the respective strata.</p></td>
    </tr>
    <tr>
      <th>trait</th>
      <td><p>A named numeric vector (values <code>0</code>, <code>1</code> and <code>NA</code>) or
    logical vector (values <code>FALSE</code>, <code>TRUE</code> and <code>NA</code>) with
    the names matching the ids of the individuals in the pedigree. The
    method internally matches and re-orders the trait vector to match
    the ordering of the ids in the pedigree.</p>
<p>If trait is not specified, the trait information stored within the
    <code>FAData</code> object is used.</p></td>
    </tr>
    <tr>
      <th>traitName</th>
      <td><p>The name of the trait (optional).</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>For <code>sliceAge</code>: a numeric vector representing the age of
    individuals.
    For <code>factor2matrix</code>: a factor that should be converted into a
    matrix.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>For <code>genealogicalIndexTest</code>: additional arguments passed to the choosen
    <code>controlSetMethod</code> function (e.g. <code>match.using</code> for
    <code><a href='defineControls.html'>getExternalMatched</a></code>).</p>
<p>For <code>familialIncidenceRateTest</code>: use <code>lowMem=TRUE</code> for
  very large pedigrees. This will use a faster and less memory demanding
  p-value estimation.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Stratified sampling: some of the familial aggregation methods allow to
  use stratified sampling for the Monte Carlo simulations. In stratified
  sampling, the same number of random samples will be selected within each
  class/stratum then there are among the affected. As example, if 5
  female and 2 male individuals are affected in the analysed trait and
  sex stratified sampling is performed, in each permuatation the same
  number of random samples in each group (i.e. 5 females and 2 males)
  are selected.</p>
<p>A note on singletons: for all per-individual measures, unconnected individuals
  within the pedigree are automatically excluded from the calculations as no
  kinship based statistic can be estimated for them since they do, by definition,
  not share kinship with any other individual in the pedigree.</p>
    <h2 class="hasAnchor" id="familial-aggregation-methods"><a class="anchor" href="#familial-aggregation-methods"></a>Familial aggregation methods</h2>

    

<p></p><dl>

    <dt>binomialTest</dt><dd><p>Evaluate whether the number of affected in a trait are higher than
      expected by chance using a simple binomial test. In contrast to
      most other methods presented here, this does not use the kinship
      between affected individuals, but simply performs a binomial test
      for each family considering the numbers of affected within the
      family, the size of the family and the global probability of being
      affected. The latter is by default calculated on the data set
      (ratio between the total number of affected in the pedigree and
      the total number of phenotyped individuals), can however also be
      specified with the <code>prob</code> argument.      The test is performed using the <code><a href='https://rdrr.io/r/stats/binom.test.html'>binom.test</a></code>.      The function returns a <code><a href='FABinTestResults.html'>FABinTestResults</a></code> object.</p></dd>
    
    <dt>familialIncidenceRate</dt><dd><p>Calculate the familial incidence rate (FIR, or FR) as defined in [Kerber
      1995], formula (3). The FIR is an estimate for the risk per
      gene-time for each individual for a certain disease (trait) given
      the disease experience in the cohort. The measure considers the
      kinship of each individual with any affected individual in the
      pedigree and the time at risk for each individual.      Internally, the function first excludes individuals from the test
      which have a missing value (<code>NA</code>) either in the argument
      <code>trait</code> or in the argument <code>timeAtRisk</code>. Next, the thus
      reduced pedigree, is further cleaned by removing all resulting
      singletons (i.e. individuals that do not share kinship with any
      other individual in the above reduced data set).      The method returns a vector with the FIR value for each
      individual. Individuals that were excluded from the test as
      described above habe an FIR of <code>NA</code>.</p></dd>

    <dt>familialIncidenceRateTest</dt><dd><p>Calculates the familial incidence rate for each individual and in
      addition assesses the significance of these based on Monte Carlo
      simulations. See <code><a href='FAIncidenceRateResults.html'>FAIncidenceRateResults</a></code> for
      more details.      The method returns a <code><a href='FAIncidenceRateResults.html'>FAIncidenceRateResults</a></code>
      object.</p></dd>

    <dt>fsir</dt><dd><p>Calculate the familial standardized incidence rate (FSIR) as
      defined in [Kerber, 1995], formula (4). The FSIR weights the
      disease status of relatives based on their degree of relatedness
      with the proband [Kerber, 1995]. Formally, the FSIR is defined as
      the standardized incidence ratio (SIR) or standardized morality
      ratio in epidemiology, i.e. as the ratio between the observed and
      expected number of cases, only that both are in addition also
      weighted by the degree of relatedness (i.e. kinship value) between
      individuals in the pedigree.      Similar to <code>familialIncidenceRate</code>, the function excludes
      individuals with missing values in any of the arguments
      <code>trait</code>, <code>timeInStrata</code> (and optionally <code>strata</code>)
      and all individuals that do not share any kinship with any other
      individual in the pedigree after removing the above individuals.      The method returns a vector with the FSIR value for each
      individual. Individuals excluded as above describe have a FSIR value
      of <code>NA</code>.</p></dd>

    <dt>fsirTest</dt><dd><p>Calculates the familial standardized incidence rate (FSIR) for
      each individual and in addition assesses the significance of these
      based on Monte Carlo simulations. See
      <code><a href='FAStdIncidenceRateResults.html'>FAStdIncidenceRateResults</a></code> for more details.      The method returns a <code><a href='FAStdIncidenceRateResults.html'>FAStdIncidenceRateResults</a></code>
      object.</p></dd>

    <dt>genealogicalIndexTest</dt><dd><p>Performs the <em>genealogical index</em> analysis from [Hill
      1980] (also known as the <em>genealogical index of
      familiality</em> or <code>genetic index of familiality</code>) to identify
      familial clustering of traits (e.g. cancers etc).      This test calculates the mean kinship among affected individuals in a
      pedigree along with mean kinships of equal sized random control
      sets drawn form the pedigree. The distribution of average kinship
      values among these random sets is used to estimate the probability
      that the observed mean kinship between the affected individuals is due
      to chance.
      The <code>controlSetMethod</code> argument allows to specify the method
      to define sets of matched control individuals in a pedigree or
      family.      Note that by default singletons (i.e. unconnected individuals in
      the pedigree) are removed from the pedigree prior the
      analysis. Set <code>rm.singletons=FALSE</code> if you do not want them
      to be removed.      The method can also be performed separately for each family within
      the larger pedigree (<code>perFamilyTest=TRUE</code> to evaluate the
      presence of clustered affected within each family).
      In this case it is also possible to
      use <code>controlSetMethod="getGenerationMatched"</code> or
      <code>controlSetMethod="getGenerationSexMatched"</code>, which allows to
      draw random control samples from the same generation(s) than the
      affected are.      Stratified random sampling can be performed with the <code>strata</code>
      argument. See details for more information.      The function returns a <code><a href='FAGenIndexResults.html'>FAGenIndexResults</a></code> object.</p></dd>

    <dt>kinshipGroupTest</dt><dd><p>Performs a familial aggregation test on a subset of a family. The
      idea behind this test is to narrow down the set of controls for
      each affected individual by considering only individuals that are
      as closely related as the most distant affected individual. This
      strategy incorporates more the family structure of the cases and
      is meant to be an alternative to the <code>kinshipSumTest</code>
      method.      Initially, for an affected individual <em>i</em> a group <em>C(i)</em>
      is created that contains all individuals that share kinship as far as
      the most distantly related affected individual. This cluster can be
      interpreted as a circle that is centered at individual <em>i</em> with
      radius equal to the most distantly related case. Therefore, the
      cluster defines a narrowed, individual-specific set of individuals
      in which the phenotype is assumed to have been passed on.
      Groups consisting of the same set of affected individuals are
      reduced to a single group (i.e. the group with the smallest total
      number of individuals).      Based on this definition of groups <em>C(i)</em>, we compute two
      statistics by performing Monte Carlo simulations (which optionally
      allow to perform stratified random sampling). During each
      simulation step affected cases are randomly sampled from the
      population.      1. The ratio test counts per group <em>C(i)</em> the number of times
      we observe a higher number of affected individuals in the simulation
      than in the observed case. Dividing this number by the number of
      simulation steps yields immediately the p-value that describes the
      event to observe by chance a higher number of affected individuals
      than in the given case.      2. The kinship test addresses the degree of relatedness within the
      simulated set by a counting method where we count the number of times
      in a simulation step there is a pair of affected individuals that are
      more closely related than in the observed group <em>C(i)</em>. In case
      the closest degree of relatedness is equal in both the simulation
      step and the observed case, we look at the number of pairs found in
      both and count it if this number is higher in the simulation
      step. Again, dividing this count by the number of simulation steps
      readily yields a p-value.      See also the method <code>runSimulation</code> for
      <code><a href='FAKinGroupResults.html'>FAKinGroupResults</a></code>.      The function returns a <code><a href='FAKinGroupResults.html'>FAKinGroupResults</a></code> object.</p></dd>

    <dt>kinshipSumTest</dt><dd><p>Performs a test for familial aggregation based on the sum of kinship
      values between affected cases. This test highlights individuals that
      exhibit a higher than chance relationship to other affected
      individuals, therefore highlighting individuals within families
      aggregating the phenotype. To achieve this, for each affected
      individual the sum of kinship values to all other affected cases is
      computed. In a Monte Carlo simulation this is repeated with the same
      number of cases (and optionally stratified with the <code>strata</code>
      argument), and the resulting background distribution is used to
      compute p-values for the kinship sums obtained from the observed
      cases. See also the method <code>runSimulation</code> for
      <code><a href='FAKinSumResults.html'>FAKinSumResults</a></code>.      The function returns a <code><a href='FAKinSumResults.html'>FAKinSumResults</a></code> object.</p></dd>

    <dt>probabilityTest</dt><dd><p>DEPRECATED: this test will be removed in Bioconductor version 3.8
      due to problems and incompatibilities of the <code>gap</code> package on
      MS Windows systems.      This is only a convience method that calls the <code>gap</code> package's
      method <code>pfc.sim</code> to compute probabilities of familial clustering
      of phenotypes [Yu and Zelterman (2002)]. One drawback of that method
      is that it is limited to families with at most 22 individuals. Thus,
      pedigrees need to be split with specialized software such as Jenti
      [Falchi and Fuchsberger ea. (2008)], which within large families
      define cliques that can then be used as input to this algorithm.      See also method <code>runSimulation</code> for
      <code><a href='FAProbResults.html'>FAProbResults</a></code>.      The function returns a <code><a href='FAProbResults.html'>FAProbResults</a></code> object.</p></dd>


  
</dl>

    <h2 class="hasAnchor" id="utility-functions"><a class="anchor" href="#utility-functions"></a>Utility functions</h2>

    

<p></p><dl>

    <dt>factor2matrix</dt><dd><p>Converts a factor into a matrix with columns corresponding to the
      levels and values (cell row i, column j) being either 0 or 1
      depending on whether the ith factor was of the level j. See
      examples below for in or <code>FAStdIncidenceRateResults</code>.</p></dd>

    <dt>estimateTimeAtRisk</dt><dd><p>Function to calculate the time at risk based on the start date of
      the study or the birth date of an individual (<code>startDate</code>)
      and the study's end date (<code>endDate</code>), the date of an
      incidence (e.g. date of diagnosis of a cancer
      <code>incidenceDate</code>) or the death of the individual
      (<code>deathDate</code>). The time at risk for each individual is
      calculated as the minimal time period between <code>startDate</code> and
      any of <code>endDate</code>, <code>incidenceDate</code> or
      <code>deathDate</code>. Thus it is also possible to provide just the
      <code>endDate</code> along with the <code>startDate</code>, in which case the
      <code>endDate</code> should be the earliest time point of: end date of
      the study, incidence date or date of death.      For affected individuals (those for which either an incidence date
      is provided or the value in the optional argument <code>affected</code>
      is <code>TRUE</code> or bigger than 0), by default half of the time unit
      is subtracted. For example, a individual that has an incidence
      after 2 days is 1.5 days at risk. The proportion of the time unit
      to subtract can be specified with the argument
      <code>incidenceSubtract</code>.      The function returns a numeric vector with the time at risk in
      days.</p></dd>

    <dt>sliceAge</dt><dd><p>Generates a matrix with columns corresponding to age slices/strata
      defined by argument <code>slices</code> and rows to individuals. Each
      cell in a row represents the time spent by the individual in the
      age slice/strata. See example below.</p></dd>

  
</dl>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Refer to the method and function description above for detailed
  information on the returned result object.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Rainer J, Talliun D, D'Elia Y, Domingues FS and Weichenberger CX
  (2016) FamAgg: an R package to evaluate familial aggregation of traits
  in large pedigrees. <em>Bioinformatics</em>.</p>  
<p>Hill, J.R. (1980) A survey of cancer sites by kinship in the Utah Mormon
  population. In Cairns J, Lyon JL, Skolnick M (eds):
  <em>Cancer Incidence in Defined Populations. Banbury Report 4.</em>
  Cold Spring Harbor, NY: Cold Spring Harbor Laboratory Press, pp 299--318.</p>
<p>Kerber, R.A. (1995) Method for calculating risk associated with family
  history of a disease. <em>Genet Epidemiol</em>, pp 291--301.</p>
<p>Yu, C. and Zelterman, D. (2002) Statistical inference for familial disease
  clusters. <em>Biometrics</em>, pp 481--491</p>
<p>Falchi, M. and Fuchsberger, C. (2008) Jenti: an efficient tool for mining
  complex inbred genealogies. <em>Bioinformatics</em>, pp 724--726</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/kinship2/man/pedigree.html'>pedigree</a></code>,
  <code><a href='FAData.html'>FAData</a></code>,
  <code><a href='FAProbResults.html'>FAProbResults</a></code>,
  <code><a href='FAKinGroupResults.html'>FAKinGroupResults</a></code>,
  <code><a href='FAKinSumResults.html'>FAKinSumResults</a></code>,
  <code><a href='FAIncidenceRateResults.html'>FAIncidenceRateResults</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>##########################</span>
<span class='co'>##</span>
<span class='co'>##  Defining a small pedigree</span>
<span class='co'>##</span>
<span class='co'>## load the Minnesota Breast Cancer record and subset to the</span>
<span class='co'>## first families.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>minnbreast</span>)
<span class='no'>mbsub</span> <span class='kw'>&lt;-</span> <span class='no'>minnbreast</span>[<span class='no'>minnbreast</span>$<span class='no'>famid</span><span class='kw'>==</span><span class='fl'>4</span> <span class='kw'>|</span> <span class='no'>minnbreast</span>$<span class='no'>famid</span><span class='kw'>==</span><span class='fl'>5</span> <span class='kw'>|</span>
                    <span class='no'>minnbreast</span>$<span class='no'>famid</span><span class='kw'>==</span><span class='fl'>14</span> <span class='kw'>|</span> <span class='no'>minnbreast</span>$<span class='no'>famid</span><span class='kw'>==</span><span class='fl'>8</span>, ]
<span class='no'>mbped</span> <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>[, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"famid"</span>, <span class='st'>"id"</span>, <span class='st'>"fatherid"</span>, <span class='st'>"motherid"</span>, <span class='st'>"sex"</span>)]
<span class='co'>## renaming column names</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>mbped</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"family"</span>, <span class='st'>"id"</span>, <span class='st'>"father"</span>, <span class='st'>"mother"</span>, <span class='st'>"sex"</span>)
<span class='co'>## create the FAData object</span>
<span class='no'>fad</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='FAData.html'>FAData</a></span>(<span class='kw'>pedigree</span><span class='kw'>=</span><span class='no'>mbped</span>)</div><div class='output co'>#&gt; <span class='message'>Generating the kinship matrix...</span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'>
<span class='co'>## We specify the cancer trait.</span>
<span class='no'>tcancer</span> <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>$<span class='no'>cancer</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>tcancer</span>) <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>$<span class='no'>id</span>

<span class='co'>##########################</span>
<span class='co'>##</span>
<span class='co'>## Familial Incidence Rate</span>
<span class='co'>##</span>
<span class='co'>## Calculate the FR for each individual given the affected status of</span>
<span class='co'>## each individual in trait cancer and the time at risk for each</span>
<span class='co'>## participant. We use column "endage" in the minnbreast data.frame</span>
<span class='co'>## that specifies the age at the last follow-up or incident cancer as a</span>
<span class='co'>##rather impresice estimate for time at risk.</span>
<span class='no'>fr</span> <span class='kw'>&lt;-</span> <span class='fu'>familialIncidenceRate</span>(<span class='no'>fad</span>, <span class='kw'>trait</span><span class='kw'>=</span><span class='no'>tcancer</span>, <span class='kw'>timeAtRisk</span><span class='kw'>=</span><span class='no'>mbsub</span>$<span class='no'>endage</span>)</div><div class='output co'>#&gt; <span class='message'>Cleaning data set (got in total 191 individuals):</span></div><div class='output co'>#&gt; <span class='message'> * not phenotyped individuals...</span></div><div class='output co'>#&gt; <span class='message'> 62 removed.</span></div><div class='output co'>#&gt; <span class='message'> * individuals with unknown time at risk...</span></div><div class='output co'>#&gt; <span class='message'> 22 removed.</span></div><div class='output co'>#&gt; <span class='message'> * singletons (also caused by previous subsetting)...</span></div><div class='output co'>#&gt; <span class='message'> 19 removed.</span></div><div class='output co'>#&gt; <span class='message'>Done</span></div><div class='input'>
<span class='co'>## Plot the distribution of familial rates</span>
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/density.html'>density</a></span>(<span class='no'>fr</span>, <span class='kw'>na.rm</span><span class='kw'>=</span><span class='fl'>TRUE</span>))</div><div class='img'><img src='FAData-analysis-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Perform in addition Monte Carlo simulations to assess the significance</span>
<span class='co'>## for the familial incidence rates.</span>
<span class='no'>frRes</span> <span class='kw'>&lt;-</span> <span class='fu'>familialIncidenceRateTest</span>(<span class='no'>fad</span>, <span class='kw'>trait</span><span class='kw'>=</span><span class='no'>tcancer</span>,
                                   <span class='kw'>timeAtRisk</span><span class='kw'>=</span><span class='no'>mbsub</span>$<span class='no'>endage</span>,
                                   <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>500</span>)</div><div class='output co'>#&gt; <span class='message'>Cleaning data set (got in total 191 individuals):</span></div><div class='output co'>#&gt; <span class='message'> * not phenotyped individuals...</span></div><div class='output co'>#&gt; <span class='message'> 62 removed.</span></div><div class='output co'>#&gt; <span class='message'> * individuals with unknown time at risk...</span></div><div class='output co'>#&gt; <span class='message'> 22 removed.</span></div><div class='output co'>#&gt; <span class='message'> * singletons (also caused by previous subsetting)...</span></div><div class='output co'>#&gt; <span class='message'> 19 removed.</span></div><div class='output co'>#&gt; <span class='message'>Done</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='FAProbResults.html'>result</a></span>(<span class='no'>frRes</span>))</div><div class='output co'>#&gt;     trait_name total_phenotyped total_affected total_tested  id family
#&gt; 446         NA              129             15           88 446     14
#&gt; 449         NA              129             15           88 449     14
#&gt; 453         NA              129             15           88 453     14
#&gt; 445         NA              129             15           88 445     14
#&gt; 454         NA              129             15           88 454     14
#&gt; 447         NA              129             15           88 447     14
#&gt;             fir pvalue      padj
#&gt; 446 0.007424662  0.002 0.1173333
#&gt; 449 0.006915362  0.004 0.1173333
#&gt; 453 0.006629813  0.004 0.1173333
#&gt; 445 0.006758000  0.008 0.1760000
#&gt; 454 0.006481794  0.014 0.2464000
#&gt; 447 0.005487605  0.028 0.4000000</div><div class='input'>

<span class='co'>##########################</span>
<span class='co'>##</span>
<span class='co'>## Familial Standardized Incidence Rate:</span>
<span class='co'>## Please see examples of FAStdIncidenceRateResults.</span>



<span class='co'>##########################</span>
<span class='co'>##</span>
<span class='co'>##  Perform familial aggregation analyses using the genealogical index</span>
<span class='co'>##</span>
<span class='no'>gi</span> <span class='kw'>&lt;-</span> <span class='fu'>genealogicalIndexTest</span>(<span class='no'>fad</span>, <span class='kw'>trait</span><span class='kw'>=</span><span class='no'>tcancer</span>, <span class='kw'>traitName</span><span class='kw'>=</span><span class='st'>"cancer"</span>,
                            <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>500</span>)</div><div class='output co'>#&gt; <span class='message'>Removing singletons...</span></div><div class='output co'>#&gt; <span class='message'> 43 removed.</span></div><div class='output co'>#&gt; <span class='message'>Cleaning data set (got in total 148 individuals):</span></div><div class='output co'>#&gt; <span class='message'> * not phenotyped individuals among selected controls...</span></div><div class='output co'>#&gt; <span class='message'> 36 removed.</span></div><div class='output co'>#&gt; <span class='message'>Done</span></div><div class='input'><span class='fu'><a href='FAProbResults.html'>result</a></span>(<span class='no'>gi</span>)</div><div class='output co'>#&gt;   trait_name total_phenotyped total_affected entity_id entity_ctrls
#&gt; 1     cancer              129             15         1          112
#&gt;   entity_affected genealogical_index pvalue  padj
#&gt; 1              13           4086.538  0.018 0.018</div><div class='input'><span class='co'>## A significant clustering of cancer cases was identified in the</span>
<span class='co'>## analyzed pedigree.</span>

<span class='co'>## Plotting the observed mean kinship and the distribution of mean kinship</span>
<span class='co'>## from the random sampling.</span>
<span class='fu'><a href='FAGenIndexResults.html'>plotRes</a></span>(<span class='no'>gi</span>)</div><div class='img'><img src='FAData-analysis-2.png' alt='' width='700' height='433' /></div><div class='input'>

<span class='co'>##########################</span>
<span class='co'>##</span>
<span class='co'>##  Perform familial aggregation analysis using the kinship sum test</span>
<span class='co'>##</span>
<span class='no'>kcr</span> <span class='kw'>&lt;-</span> <span class='fu'>kinshipSumTest</span>(<span class='no'>fad</span>, <span class='kw'>trait</span><span class='kw'>=</span><span class='no'>tcancer</span>, <span class='kw'>traitName</span><span class='kw'>=</span><span class='st'>"cancer"</span>,
                      <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>500</span>)</div><div class='output co'>#&gt; <span class='message'>Cleaning data set (got in total 191 individuals):</span></div><div class='output co'>#&gt; <span class='message'> * not phenotyped individuals...</span></div><div class='output co'>#&gt; <span class='message'> 62 removed</span></div><div class='output co'>#&gt; <span class='message'>Done</span></div><div class='input'><span class='no'>kcr</span></div><div class='output co'>#&gt; FAKinSumResults object with:
#&gt;  * Pedigree of length 191.
#&gt;  * Number of unique individuals: 191.
#&gt;  * Number of families: 4.
#&gt;  * Number of individuals in largest family: 70.
#&gt;  * Number of individuals in smallest family: 38.
#&gt; Information on trait 'cancer'
#&gt;  * Number of non-NA values: 129.
#&gt;  * Number of non-zero values: 15.
#&gt; Result info:
#&gt;  * Number of rows of the result data.frame: 15.
#&gt;  * Number of simulations: 500.</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='FAProbResults.html'>result</a></span>(<span class='no'>kcr</span>))</div><div class='output co'>#&gt;     trait_name total_phenotyped total_affected affected_id family affected
#&gt; 447     cancer              129             15         447     14       15
#&gt; 450     cancer              129             15         450     14       15
#&gt; 451     cancer              129             15         451     14       15
#&gt; 452     cancer              129             15         452     14       15
#&gt; 142     cancer              129             15         142      8       15
#&gt; 444     cancer              129             15         444     14       15
#&gt;     kinship_sum      freq      pvalue   padj
#&gt; 447       1.000 0.2133333 0.004266667 0.0565
#&gt; 450       0.875 0.6800000 0.015066667 0.0565
#&gt; 451       0.875 0.6800000 0.015066667 0.0565
#&gt; 452       0.875 0.6800000 0.015066667 0.0565
#&gt; 142       0.625 2.9600000 0.078000000 0.1950
#&gt; 444       0.625 2.9600000 0.078000000 0.1950</div><div class='input'>

<span class='co'>##########################</span>
<span class='co'>##</span>
<span class='co'>##  Perform familial aggregation analysis using the kinship group test,</span>
<span class='co'>##  stratifying by sex</span>
<span class='co'>##</span>
<span class='no'>kr</span> <span class='kw'>&lt;-</span> <span class='fu'>kinshipGroupTest</span>(<span class='no'>fad</span>, <span class='kw'>trait</span><span class='kw'>=</span><span class='no'>tcancer</span>, <span class='kw'>traitName</span><span class='kw'>=</span><span class='st'>"cancer"</span>,
                       <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>500</span>, <span class='kw'>strata</span><span class='kw'>=</span><span class='no'>fad</span>$<span class='no'>sex</span>)</div><div class='output co'>#&gt; <span class='message'>Cleaning data set (got in total 191 individuals):</span></div><div class='output co'>#&gt; <span class='message'> * not phenotyped individuals...</span></div><div class='output co'>#&gt; <span class='message'> 62 removed</span></div><div class='output co'>#&gt; <span class='message'> * affected individuals without valid strata values...</span></div><div class='output co'>#&gt; <span class='message'> none present.</span></div><div class='output co'>#&gt; <span class='message'> * unaffected individuals without valid strata values...</span></div><div class='output co'>#&gt; <span class='message'> 3 removed.</span></div><div class='output co'>#&gt; <span class='message'>Done</span></div><div class='input'><span class='no'>kr</span></div><div class='output co'>#&gt; FAKinGroupResults object with:
#&gt;  * Pedigree of length 191.
#&gt;  * Number of unique individuals: 191.
#&gt;  * Number of families: 4.
#&gt;  * Number of individuals in largest family: 70.
#&gt;  * Number of individuals in smallest family: 38.
#&gt; Information on trait 'cancer'
#&gt;  * Number of non-NA values: 129.
#&gt;  * Number of non-zero values: 15.
#&gt; Result info:
#&gt;  * Dimension of result data.frame: 3.
#&gt;   * Dimension of result data.frame: 14.
#&gt;  * Number of simulations: 500.</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='FAProbResults.html'>result</a></span>(<span class='no'>kr</span>))</div><div class='output co'>#&gt;     trait_name total_phenotyped total_affected phenotyped affected group_id
#&gt; 447     cancer              129             15         43       11      447
#&gt; 136     cancer              129             15         43       11      136
#&gt; 11      cancer              129             15         43       11       11
#&gt;     family group_phenotyped group_affected ratio_pvalue ratio_padj mean_kinship
#&gt; 447     14               12              5        0.006      0.018    0.2500000
#&gt; 136      8               19              4        0.178      0.267    0.1666667
#&gt; 11       4               12              2        0.550      0.550    0.1250000
#&gt;     kinship_pvalue kinship_padj
#&gt; 447          0.000        0.000
#&gt; 136          0.154        0.231
#&gt; 11           0.490        0.490</div><div class='input'>


<span class='co'>##########################</span>
<span class='co'>##</span>
<span class='co'>##  Estimate the time at risk given</span>
<span class='co'>##</span>
<span class='co'>## Define some birth dates and incidence dates and end date of study</span>
<span class='no'>bdates</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"2012-04-17"</span>, <span class='st'>"2014-05-29"</span>, <span class='st'>"1999-12-31"</span>, <span class='st'>"2002-10-10"</span>)
<span class='no'>idates</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>NA</span>, <span class='fl'>NA</span>, <span class='st'>"2007-07-13"</span>, <span class='st'>"2013-12-23"</span>)
<span class='no'>edates</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='st'>"2015-09-15"</span>, <span class='fl'>4</span>)

<span class='co'>## Estimate the time at risk. The time period is returned in days.</span>
<span class='no'>riskDays</span> <span class='kw'>&lt;-</span> <span class='fu'>estimateTimeAtRisk</span>(<span class='kw'>startDate</span><span class='kw'>=</span><span class='no'>bdates</span>, <span class='kw'>incidenceDate</span><span class='kw'>=</span><span class='no'>idates</span>, <span class='kw'>endDate</span><span class='kw'>=</span><span class='no'>edates</span>)</div><div class='output co'>#&gt; <span class='message'>Transforming startDate into Date format...</span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='output co'>#&gt; <span class='message'>Transforming endDate into Date format...</span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='output co'>#&gt; <span class='message'>Transforming incidenceDate into Date format...</span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'><span class='no'>riskDays</span></div><div class='output co'>#&gt; [1] 1246.0  474.0 2750.5 4091.5</div><div class='input'>
<span class='co'>##########################</span>
<span class='co'>##</span>
<span class='co'>##  Define the time spent in an age stratum given the indivduals'</span>
<span class='co'>##  age at incidence or end of study.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>mbsub</span>$<span class='no'>endage</span>)</div><div class='output co'>#&gt; [1]       NA 78.05886 55.50000 48.00000 75.00342 53.63997</div><div class='input'><span class='co'>## We "slice" the age in specified intervals/slices</span>
<span class='no'>stratAge</span> <span class='kw'>&lt;-</span> <span class='fu'>sliceAge</span>(<span class='no'>mbsub</span>$<span class='no'>endage</span>, <span class='kw'>slices</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>40</span>, <span class='fl'>60</span>, <span class='fl'>Inf</span>))
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>stratAge</span>)</div><div class='output co'>#&gt;      (0, 40] (40, 60] (60, Inf]
#&gt; [1,]      NA       NA        NA
#&gt; [2,]      40 20.00000  18.05886
#&gt; [3,]      40 15.50000   0.00000
#&gt; [4,]      40  8.00000   0.00000
#&gt; [5,]      40 20.00000  15.00342
#&gt; [6,]      40 13.63997   0.00000</div><div class='input'>
<span class='co'>## The first column lists the number of years spent in the first age</span>
<span class='co'>## stratum (0 &lt; age &lt;= 40) and the second in the second stratum</span>
<span class='co'>## (40 &lt; age &lt;= Inf)</span>

<span class='co'>## We could also stratify the disk days from above in per year strata.</span>
<span class='fu'>sliceAge</span>(<span class='no'>riskDays</span>/<span class='fl'>365</span>, <span class='kw'>slices</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>2.5</span>, <span class='fl'>5</span>, <span class='fl'>10</span>, <span class='fl'>20</span>))</div><div class='output co'>#&gt;      (0, 2.5]  (2.5, 5]  (5, 10] (10, 20]
#&gt; [1,]  2.50000 0.9136986 0.000000 0.000000
#&gt; [2,]  1.29863 0.0000000 0.000000 0.000000
#&gt; [3,]  2.50000 2.5000000 2.535616 0.000000
#&gt; [4,]  2.50000 2.5000000 5.000000 1.209589</div><div class='input'>

<span class='co'>##########################</span>
<span class='co'>##</span>
<span class='co'>##  Simple example for factor2matrix: generate a matrix for factor $sex</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'>factor2matrix</span>(<span class='no'>fad</span>$<span class='no'>sex</span>))</div><div class='output co'>#&gt;   M F
#&gt; 1 1 0
#&gt; 2 0 1
#&gt; 3 0 1
#&gt; 4 0 1
#&gt; 5 1 0
#&gt; 6 1 0</div><div class='input'>



</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Johannes Rainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


