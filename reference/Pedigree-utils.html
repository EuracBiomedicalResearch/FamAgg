<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Basic pedigree utilities — PedigreeUtils • FamAgg</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Basic pedigree utilities — PedigreeUtils" />
<meta property="og:description" content="Utility functions to access, modify or subset pedigrees. Most of these
  functions can be applied to simple data.frame in pedigree
  format or pedigree or pedigreeList objects defined in
  the kinship2 package." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FamAgg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.17.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/FamAgg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/EuracBiomedicalResearch/FamAgg/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Basic pedigree utilities</h1>
    
    <div class="hidden name"><code>Pedigree-utils.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Utility functions to access, modify or subset pedigrees. Most of these
  functions can be applied to simple <code>data.frame</code> in pedigree
  format or <code>pedigree</code> or <code>pedigreeList</code> objects defined in
  the <code>kinship2</code> package.</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for missing</span>
<span class='fu'><a href='FAProbResults.html'>cliques</a></span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='fu'>connectedSubgraph</span>(<span class='no'>graph</span>, <span class='no'>nodes</span>, <span class='kw'>mode</span><span class='kw'>=</span><span class='st'>"all"</span>, <span class='kw'>all.nodes</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='no'>ifnotfound</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>countGenerations</span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>direction</span><span class='kw'>=</span><span class='st'>"down"</span>, <span class='no'>...</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>estimateGenerations</span>(<span class='no'>object</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>findFounders</span>(<span class='no'>object</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>id</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>generationsFrom</span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>getAncestors</span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>max.generations</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='no'>...</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>getChildren</span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>max.generations</span><span class='kw'>=</span><span class='fl'>16</span>, <span class='no'>...</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>getCommonAncestor</span>(<span class='no'>object</span>, <span class='no'>id</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"min.dist"</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>getFounders</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>getMissingMate</span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>getSiblings</span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>getSingletons</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='fu'>ped2graph</span>(<span class='no'>ped</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>removeSingletons</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='co'># S4 method for data.frame</span>
<span class='fu'>removeSingletons</span>(<span class='no'>object</span>, <span class='no'>...</span>)

<span class='fu'>subPedigree</span>(<span class='no'>ped</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>all</span><span class='kw'>=</span><span class='fl'>TRUE</span>)

<span class='co'># S4 method for FAData</span>
<span class='fu'>shareKinship</span>(<span class='no'>object</span>, <span class='no'>id</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>all</th>
      <td><p>For <code>subPedigree</code>: if all individuals have to be present in the
    sub-pedigree.</p></td>
    </tr>
    <tr>
      <th>all.nodes</th>
      <td><p>For <code>connectedSubgraph</code>: if all nodes have to be present in the
    resulting graph, or only those that are connected with each other.</p></td>
    </tr>
    <tr>
      <th>direction</th>
      <td><p>For <code>countGenerations</code>: whether the number of ancestor (<code>"up"</code>)
    generations or offspring (<code>"down"</code>) generation should be counted.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>A character or numeric representing the family id.
    For <code>doFindFounders</code>: the id of the family in the pedigree for
    which the founders should be identified. Uses the first family in
    the pedigree if not specified.
    For <code>estimateGenerations</code>: optional id of the family if
    generation numbers should only be calculated for one
    family. Otherwiseif, the generations are estimated for all families
    (separately) in the object.</p></td>
    </tr>
    <tr>
      <th>graph</th>
      <td><p>An <code>igraph</code> graph object.</p></td>
    </tr>
    <tr>
      <th>id</th>
      <td><p>A character or numeric vector length 1 or longer specifying the
    id(s) of the individual(s).
    For <code>generationsFrom</code> and <code>findFounders</code> only a single id
    should be submitted.</p></td>
    </tr>
    <tr>
      <th>ifnotfound</th>
      <td><p>For <code>connectedSubgraph</code>: if not defined, the function throws an
    error if no subgraph can be specified. If defined, its value is
    returned if no subgraph was found.</p></td>
    </tr>
    <tr>
      <th>max.generations</th>
      <td><p>For <code>getAncestors</code> and <code>getChildren</code>: the maximal
    number of ancestor or offspring generations that should be returned.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>For <code>getCommonAncestor</code>: the method by which the closest
    common ancestor sould be identified. Either <code>"min.dist"</code>
    (ancestor with the minimal distance to any of the individuals) or
    <code>"smallest.mean.dist"</code> (ancestor with the smallest mean
    distance to any of the individuals).</p></td>
    </tr>
    <tr>
      <th>mode</th>
      <td><p>For <code>connectedSubgraph</code>: either <code>"all"</code>, <code>"in"</code>,
    <code>"out"</code> specifying how distances and paths between individual
    nodes should be determined. See help for function
    <code>shortest_paths</code> in package <code>igraph</code> for more details.</p></td>
    </tr>
    <tr>
      <th>nodes</th>
      <td><p>For <code>connectedSubgraph</code>: A character vector of node (vertex) names
    for which the subgraph should be defined.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>For <code>cliques</code>: passed to the <code>cliques</code> function
    from the <code>igraph</code> package.
    For all other methods: either a <code><a href='FAData.html'>FAData</a></code> object
    (or any object inheriting from it), a <code>data.frame</code>,
    <code>pedigree</code> or <code>pedigreeList</code> objects (the latter being
    defined in the <code>kinship2</code> package).</p></td>
    </tr>
    <tr>
      <th>ped</th>
      <td><p>Either a <code>data.frame</code> or a <code>pedigree</code> object specifying
    the pedigree. If a <code>data.frame</code> is submitted, the columns
    <code>id</code>, <code>family</code>, <code>father</code>, <code>mother</code> and
    <code>sex</code> are required.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>For <code>cliques</code>: additional arguments passed to the
    <code>cliques</code> function from the <code>igraph</code> package.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="basic-pedigree-utilities"><a class="anchor" href="#basic-pedigree-utilities"></a>Basic pedigree utilities</h2>

    

<p></p><dl>

    <dt>countGenerations</dt><dd><p>Count the generations up- or down the pedigree for the specified
      individual(s), i.e. determine the number of ancestor or offspring
      generations defined in the pedigree for the specified
      individual(s).
      Returns a named numeric vector, names corresponding to the
      individual's id, with the number of generations for each specified
      individual.</p></dd>

    <dt>findFounders</dt><dd><p>Identifies the founder couple with the largest number of offspring
      generations in the pedigree. The provided pedigree
      object/data.frame can contain pedigrees of multiple families,
      thus, to identify the founder pair for a family its ID can be
      provided with the <code>family</code> parameter. Alternatively, the ID
      of an individual can be specified, in which case the founder pair
      of the (full) pedigree of the specified individual is identified.
      If two or more couples have the same, largest number of
      offspring generations, the first couple is selected.
      Returns a character vector of length 2 with the ids of the founder
      individuals.</p></dd>

    <dt>getFounders</dt><dd><p>Returns the ids of all founders in the pedigree. A founder is an
      individual from which neither father nor mother is known in the
      pedigree.</p></dd>

    <dt>getSingletons</dt><dd><p>Returns the ids of all singletons, i.e. individuals in the
      pedigree that are not connected to any other individual (have no
      parents in the pedigree and no children).</p></dd>

    <dt>getAncestors</dt><dd><p>Identify and return the ids of ancestor generations (up to
      <code>max.generations</code>) for the specified individual(s).</p></dd>

    <dt>getChildren</dt><dd><p>Identify and return the ids of offspring generations (up to
      <code>max.generations</code>) for the specified individual(s).</p></dd>

    <dt>getCommonAncestor</dt><dd><p>Finds the closest common ancestor between specified individuals (2
      or more ids are required).
      Returns a character vector with the ids of the ancestors or <code>NA</code> if
      no common ancestor was found.</p></dd>

    <dt>getMissingMate</dt><dd><p>The function evaluates if in the sub-pedigree defined by the
      specified ids one or more mates (spouse) are
      missing and if so it returns their ids.</p></dd>

    <dt>getSiblings</dt><dd><p>Get siblings for the specified id(s). Returns their ids as
      character, or numeric vector.</p></dd>

    <dt>removeSingletons</dt><dd><p>Removes all unconnected individuals (i.e. singletons) from the
      pedigree. Returns a <code>data.frame</code> with the pedigree cleaned
      from all singletons. Note that, due to internal sanitizing,
      columns <code>"father"</code> and <code>"mother"</code> in the resulting
      <code>data.frame</code> have a <code>NA</code> for individuals for which the
      father or mother is not known in the pedigree.</p></dd>

    <dt>subPedigree</dt><dd><p>Finds the smallest pedigree containing all specified individuals.
      Depending on the input, a <code>data.frame</code>, <code>pedigree</code>
      or <code>pedigreeList</code>.</p></dd>

  
</dl>

    <h2 class="hasAnchor" id="advanced-pedigree-methods"><a class="anchor" href="#advanced-pedigree-methods"></a>Advanced pedigree methods</h2>

    <p></p><dl>

    <dt>estimateGenerations</dt><dd><p>Estimates generation levels/numbers for each, or only one, family
      in the object. Generation numbers are always relative to the
      founder couple (defined by <code>findFounders</code>).
      Returns (always) a named list of generation numbers. The names of
      the list represent the family id, the names of the numeric vector
      of generations the id of the individuals in the family.</p></dd>

    <dt>generationsFrom</dt><dd><p>Determine generations starting from the specified
      individual. Siblings including their mates and all other in the
      same generation () are assigned generation 0, ancestor generations
      (all their parents etc) negative generation numbers, decreasing with
      ancestor level and their offspring positive numbers, increasing
      with each generation.
      Generations are only estimated within the family of the
      individual, also, if the pedigree consists of un-connected
      sub-pedigree, generation numbers will only be calculated for the
      sub-pedigree containing the specified individual.
      The function returns a named numeric vector of generation numbers,
      the names corresponding to the ids of the individuals in the
      specified individual's family. Not connected individuals in the
      family get a <code>NA</code> generation number.</p></dd>

    <dt>shareKinship</dt><dd><p>Finds all related individuals (individuals sharing kinship with
      the individual) for the specified individual(s) in the pedigree
      and returns their ids as a character vector.</p></dd>
  
</dl>

    <h2 class="hasAnchor" id="graph-theory-related-functions"><a class="anchor" href="#graph-theory-related-functions"></a>Graph theory related functions</h2>

    <p></p><dl>
    <dt>cliques</dt><dd><p>Wrapper method passing all arguments to the <code>cliques</code>
      function from the <code>igraph</code> package.</p></dd>

    <dt>connectedSubgraph</dt><dd><p>Finds the (eventually smallest) connected subgraph of all
      specified nodes.
      Returns an <code>igraph</code> object representing the subgraph of the
      specified nodes.</p></dd>

    <dt>ped2graph</dt><dd><p>Transforms the pedigree into a (directed) graph with the direction
      of the edges being always from parent to child.
      An <code>igraph</code> object.</p></dd>
  
</dl>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Refer to the method and function description above for detailed
  information on the returned result object.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/kinship2/man/pedigree.html'>pedigree</a></code>,
  <code><a href='FAData.html'>FAData</a></code>,
  <code><a href='FAProbResults.html'>FAProbResults</a></code>,
  <code><a href='FAKinGroupResults.html'>FAKinGroupResults</a></code>,
  <code><a href='FAKinSumResults.html'>FAKinSumResults</a></code>,
  <code><a href='FAData-analysis.html'>PedigreeAnalysis</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>##########################</span>
<span class='co'>##</span>
<span class='co'>##  Defining a small pedigree</span>
<span class='co'>##</span>
<span class='co'>## load the Minnesota Breast Cancer record and subset to the</span>
<span class='co'>## first families.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>minnbreast</span>)
<span class='no'>mbsub</span> <span class='kw'>&lt;-</span> <span class='no'>minnbreast</span>[<span class='no'>minnbreast</span>$<span class='no'>famid</span><span class='kw'>==</span><span class='fl'>4</span> <span class='kw'>|</span> <span class='no'>minnbreast</span>$<span class='no'>famid</span><span class='kw'>==</span><span class='fl'>5</span>, ]
<span class='no'>mbped</span> <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>[, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"famid"</span>, <span class='st'>"id"</span>, <span class='st'>"fatherid"</span>, <span class='st'>"motherid"</span>, <span class='st'>"sex"</span>)]
<span class='co'>## renaming column names</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>mbped</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"family"</span>, <span class='st'>"id"</span>, <span class='st'>"father"</span>, <span class='st'>"mother"</span>, <span class='st'>"sex"</span>)

<span class='co'>## plot the pedigree for family 4 to get an overview.</span>
<span class='fu'><a href='plotting-functions.html'>switchPlotfun</a></span>(<span class='kw'>method</span><span class='kw'>=</span><span class='st'>"ks2paint"</span>)</div><div class='output co'>#&gt; <span class='message'>Plotting backend: ks2paint.</span></div><div class='input'><span class='no'>fam4</span> <span class='kw'>&lt;-</span> <span class='no'>mbped</span>[<span class='no'>mbped</span>$<span class='no'>family</span><span class='kw'>==</span><span class='fl'>4</span>, ]
<span class='fu'><a href='plotting-functions.html'>doPlotPed</a></span>(<span class='kw'>individual</span><span class='kw'>=</span><span class='no'>fam4</span>$<span class='no'>id</span>, <span class='kw'>father</span><span class='kw'>=</span><span class='no'>fam4</span>$<span class='no'>father</span>, <span class='kw'>mother</span><span class='kw'>=</span><span class='no'>fam4</span>$<span class='no'>mother</span>,
          <span class='kw'>gender</span><span class='kw'>=</span><span class='no'>fam4</span>$<span class='no'>sex</span>, <span class='kw'>device</span><span class='kw'>=</span><span class='st'>"plot"</span>)</div><div class='img'><img src='Pedigree-utils-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; Did not plot the following people: 30 31 32 33 34 35 36 37 38 39 40 41 42 43 </div><div class='input'>
<span class='co'>## find the closest common ancestor between individuals 23, 3 and 8</span>
<span class='fu'>getCommonAncestor</span>(<span class='no'>fam4</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>23</span>, <span class='fl'>3</span>, <span class='fl'>8</span>))</div><div class='output co'>#&gt; [1] "1" "2"</div><div class='input'>
<span class='co'>## create the smallest sub-pedigree for individuals 21, 22 and 25</span>
<span class='fu'>subPedigree</span>(<span class='no'>fam4</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>21</span>, <span class='fl'>22</span>, <span class='fl'>25</span>))</div><div class='output co'>#&gt; <span class='message'>Removing singletons...</span></div><div class='output co'>#&gt; <span class='message'> none present.</span></div><div class='output co'>#&gt;    family id father mother sex
#&gt; 25      4 25     NA     NA   M
#&gt; 3       4  3     25      4   F
#&gt; 21      4 21     24      3   M
#&gt; 22      4 22     24      3   F
#&gt; 4       4  4     NA     NA   F
#&gt; 24      4 24     NA     NA   M</div><div class='input'><span class='co'>## plot that</span>
<span class='no'>fam4sub</span> <span class='kw'>&lt;-</span> <span class='fu'>subPedigree</span>(<span class='no'>fam4</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>21</span>, <span class='fl'>22</span>, <span class='fl'>25</span>))</div><div class='output co'>#&gt; <span class='message'>Removing singletons...</span></div><div class='output co'>#&gt; <span class='message'> none present.</span></div><div class='input'><span class='fu'><a href='plotting-functions.html'>doPlotPed</a></span>(<span class='kw'>individual</span><span class='kw'>=</span><span class='no'>fam4sub</span>$<span class='no'>id</span>, <span class='kw'>father</span><span class='kw'>=</span><span class='no'>fam4sub</span>$<span class='no'>father</span>, <span class='kw'>mother</span><span class='kw'>=</span><span class='no'>fam4sub</span>$<span class='no'>mother</span>,
          <span class='kw'>gender</span><span class='kw'>=</span><span class='no'>fam4sub</span>$<span class='no'>sex</span>, <span class='kw'>device</span><span class='kw'>=</span><span class='st'>"plot"</span>)</div><div class='img'><img src='Pedigree-utils-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>#########################</span>
<span class='co'>##</span>
<span class='co'>##  Basic pedigree utils</span>
<span class='co'>##</span>
<span class='co'>## Note: the same methods can be applied to a data.frame representing</span>
<span class='co'>## a pedigree, or a FAData, pedigree or pedigreeList object.</span>

<span class='co'>## Find the founder couple for family 4</span>
<span class='fu'>findFounders</span>(<span class='no'>fam4</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='fl'>4</span>)</div><div class='output co'>#&gt; [1] "1" "2"</div><div class='input'>
<span class='co'>## Alternatively, find the founders for the pedigree in which ibdividual 20 is a</span>
<span class='co'>## member</span>
<span class='fu'>findFounders</span>(<span class='no'>fam4</span>, <span class='kw'>id</span> <span class='kw'>=</span> <span class='fl'>20</span>)</div><div class='output co'>#&gt; [1] "1" "2"</div><div class='input'>
<span class='co'>## Return all founders in the pedigree.</span>
<span class='fu'>getFounders</span>(<span class='no'>fam4</span>)</div><div class='output co'>#&gt;  [1]  1  2 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43</div><div class='input'>
<span class='co'>## Get all founders without children (i.e. singletons).</span>
<span class='fu'>getSingletons</span>(<span class='no'>fam4</span>)</div><div class='output co'>#&gt;  [1] 30 31 32 33 34 35 36 37 38 39 40 41 42 43</div><div class='input'>
<span class='co'>## Clean the pedigree from all singletons</span>
<span class='no'>fam4noS</span> <span class='kw'>&lt;-</span> <span class='fu'>removeSingletons</span>(<span class='no'>fam4</span>)</div><div class='output co'>#&gt; <span class='message'>Removing singletons...</span></div><div class='output co'>#&gt; <span class='message'> 14 removed.</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>fam4</span>)</div><div class='output co'>#&gt; [1] 43</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='no'>fam4noS</span>)</div><div class='output co'>#&gt; [1] 29</div><div class='input'>
<span class='co'>## Count the offspring generations for individual "4"</span>
<span class='fu'>countGenerations</span>(<span class='no'>fam4</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='st'>"4"</span>)</div><div class='output co'>#&gt; 4 
#&gt; 2 </div><div class='input'>
<span class='co'>## Get the ids of all ancestors for that individual</span>
<span class='fu'>getAncestors</span>(<span class='no'>fam4</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='st'>"4"</span>)</div><div class='output co'>#&gt; [1] "1" "2"</div><div class='input'>
<span class='co'>## Get the ids of the children of this individual</span>
<span class='fu'>getChildren</span>(<span class='no'>fam4</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='st'>"4"</span>, <span class='kw'>max.generations</span><span class='kw'>=</span><span class='fl'>1</span>)</div><div class='output co'>#&gt; [1] "3"</div><div class='input'>
<span class='co'>## Get the ids of the complete offspring for this individuals</span>
<span class='fu'>getChildren</span>(<span class='no'>fam4</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='st'>"4"</span>)</div><div class='output co'>#&gt; [1] "3"  "21" "22" "23"</div><div class='input'>
<span class='co'>## Create a FAData object from the pedigree data.frame</span>
<span class='no'>fad</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='FAData.html'>FAData</a></span>(<span class='no'>fam4</span>)</div><div class='output co'>#&gt; <span class='message'>Generating the kinship matrix...</span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'><span class='co'>## get the list of all ids sharing kinship with individuals</span>
<span class='co'>## 5 and 9</span>
<span class='fu'>shareKinship</span>(<span class='no'>fad</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"5"</span>, <span class='st'>"9"</span>))</div><div class='output co'>#&gt;  [1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "11" "12" "13" "14" "15"
#&gt; [16] "16" "17" "18" "19" "20" "21" "22" "23"</div><div class='input'>
<span class='co'>## Count the numbers of generations of ancestors for individual 12</span>
<span class='fu'>countGenerations</span>(<span class='no'>fad</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='st'>"12"</span>, <span class='kw'>direction</span><span class='kw'>=</span><span class='st'>"up"</span>)</div><div class='output co'>#&gt; 12 
#&gt;  2 </div><div class='input'>
<span class='co'>## Count the numbers of offspring generations for individuals 2 and 29</span>
<span class='fu'>countGenerations</span>(<span class='no'>fad</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"2"</span>, <span class='st'>"29"</span>))</div><div class='output co'>#&gt;  2 29 
#&gt;  3  1 </div><div class='input'>
<span class='co'>## Get all brothers/sisters for individual 9</span>
<span class='fu'>getSiblings</span>(<span class='no'>fad</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='st'>"9"</span>)</div><div class='output co'>#&gt; [1] "4"  "5"  "6"  "7"  "8"  "9"  "10"</div><div class='input'>
<span class='co'>## Determine generation levels starting from individual "9"</span>
<span class='fu'>generationsFrom</span>(<span class='no'>fad</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='st'>"9"</span>)</div><div class='output co'>#&gt;  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 
#&gt; -1 -1  1  0  0  0  0  0  0  0  1  1  1  1  1  1  1  1  1  1  2  2  2  1  0  0 
#&gt; 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 
#&gt;  0  0  0 NA NA NA NA NA NA NA NA NA NA NA NA NA NA </div><div class='input'>
<span class='co'>## Estimate generations relative to the founder couple for each</span>
<span class='co'>## family in the submitted object, a data.frame in the example below</span>
<span class='fu'>estimateGenerations</span>(<span class='no'>mbped</span>)</div><div class='output co'>#&gt; $`4`
#&gt;  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 
#&gt;  0  0  2  1  1  1  1  1  1  1  2  2  2  2  2  2  2  2  2  2  3  3  3  2  1  1 
#&gt; 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 
#&gt;  1  1  1 NA NA NA NA NA NA NA NA NA NA NA NA NA NA 
#&gt; 
#&gt; $`5`
#&gt;    44    45    46    47    48    49    50    51    52    53    54    55    56 
#&gt;     0     0     2     2     2     2     2     2     2     2     1     3     3 
#&gt;    57    58    59    60    61    62    63    64    65    66    67    68    69 
#&gt;     3     3     3     3     3     3     3     3     2     2     2    NA     2 
#&gt;    70    71    72    73    74    75    76    77    78    79 26050 26051 
#&gt;     1    NA    NA    NA    NA    NA    NA    NA    NA     2    NA    NA 
#&gt; </div><div class='input'>

<span class='co'>#########################</span>
<span class='co'>##</span>
<span class='co'>##  Graph utilities</span>
<span class='co'>##</span>
<span class='co'>## Convert the pedigree into a graph</span>
<span class='no'>pgraph</span> <span class='kw'>&lt;-</span> <span class='fu'>ped2graph</span>(<span class='no'>fam4</span>)
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>pgraph</span>)</div><div class='img'><img src='Pedigree-utils-3.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Make a subgraph containing nodes 10, 22, 12 and 14</span>
<span class='no'>sgraph</span> <span class='kw'>&lt;-</span> <span class='fu'>connectedSubgraph</span>(<span class='no'>pgraph</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"10"</span>, <span class='st'>"22"</span>, <span class='st'>"12"</span>, <span class='st'>"14"</span>))
<span class='fu'><a href='https://rdrr.io/r/base/plot.html'>plot</a></span>(<span class='no'>sgraph</span>)</div><div class='img'><img src='Pedigree-utils-4.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Johannes Rainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


