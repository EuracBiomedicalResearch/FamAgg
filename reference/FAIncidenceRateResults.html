<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Familial Incidence Rate — FAIncidenceRateResults-class • FamAgg</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Familial Incidence Rate — FAIncidenceRateResults-class" />
<meta property="og:description" content="The FAIncidenceRateResults object contains the results from a
  familial incidence rate calculation employing in addition Monte Carlo
  simulations to assess significance levels for the familial incidence
  rate of each individual.
  The familial incidence rate (FIR, also referred to as FR in Kerber
  (1995)) is an estimate for the risk per gene-time for each individuals
  for a certain disease given the disease experience in the cohort. The
  measure considers the kinship of each individual with any affected
  individual in the pedigree and the time at risk for each.
Note that in contrast to e.g. FAKinSumResults a familial
  incidence rate and corresponding p-value are calculated and available
  for all individuals in the pedigree, not only for affected individuals." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FamAgg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.17.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/FamAgg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/EuracBiomedicalResearch/FamAgg/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Familial Incidence Rate</h1>
    
    <div class="hidden name"><code>FAIncidenceRateResults.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>FAIncidenceRateResults</code> object contains the results from a
  familial incidence rate calculation employing in addition Monte Carlo
  simulations to assess significance levels for the familial incidence
  rate of each individual.
  The familial incidence rate (FIR, also referred to as FR in Kerber
  (1995)) is an estimate for the risk per gene-time for each individuals
  for a certain disease given the disease experience in the cohort. The
  measure considers the kinship of each individual with any affected
  individual in the pedigree and the time at risk for each.</p>
<p>Note that in contrast to e.g. <code><a href='FAKinSumResults.html'>FAKinSumResults</a></code> a familial
  incidence rate and corresponding p-value are calculated and available
  for all individuals in the pedigree, not only for affected individuals.</p>
    </div>

    <pre class="usage"><span class='co'># S4 method for FAIncidenceRateResults</span>
<span class='fu'><a href='FAData-analysis.html'>familialIncidenceRate</a></span>(<span class='no'>object</span>, <span class='kw'>trait</span><span class='kw'>=</span><span class='kw'>NULL</span>,
                                                         <span class='kw'>timeAtRisk</span><span class='kw'>=</span><span class='kw'>NULL</span>,
                                                         <span class='no'>...</span>)

<span class='co'># S4 method for FAIncidenceRateResults</span>
<span class='fu'><a href='FAData.html'>plotPed</a></span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='kw'>NULL</span>,
                                           <span class='kw'>filename</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>device</span><span class='kw'>=</span><span class='st'>"plot"</span>,
                                           <span class='kw'>only.phenotyped</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='no'>...</span>)

<span class='co'># S4 method for FAIncidenceRateResults</span>
<span class='fu'><a href='FAGenIndexResults.html'>plotRes</a></span>(<span class='no'>object</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='kw'>NULL</span>,
                                           <span class='kw'>addLegend</span><span class='kw'>=</span><span class='fl'>TRUE</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"density"</span>, <span class='no'>...</span>)

<span class='co'># S4 method for FAIncidenceRateResults</span>
<span class='fu'><a href='FAProbResults.html'>result</a></span>(<span class='no'>object</span>, <span class='kw'>method</span><span class='kw'>=</span><span class='st'>"BH"</span>)

<span class='co'># S4 method for FAIncidenceRateResults</span>
<span class='fu'><a href='FAProbResults.html'>runSimulation</a></span>(<span class='no'>object</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>50000</span>,
                                                 <span class='kw'>timeAtRisk</span><span class='kw'>=</span><span class='kw'>NULL</span>,
                                                 <span class='kw'>strata</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='no'>...</span>)

<span class='co'># S4 method for FAIncidenceRateResults</span>
<span class='fu'>timeAtRisk</span>(<span class='no'>object</span>)

<span class='co'># S4 method for FAIncidenceRateResults</span>
<span class='fu'>timeAtRisk</span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span>

<span class='co'># S4 method for FAIncidenceRateResults</span>
<span class='fu'><a href='FAData.html'>trait</a></span>(<span class='no'>object</span>) <span class='kw'>&lt;-</span> <span class='no'>value</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>addLegend</th>
      <td><p>For <code>plotRes</code>: if a legend should be added to the plot.</p></td>
    </tr>
    <tr>
      <th>device</th>
      <td><p>For <code>plotPed</code>: see <code><a href='FAData.html'>plotPed</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>For <code>plotPed</code>: the family for which the pedigree should be
    plotted.
    For <code>plotRes</code>: not supported.</p></td>
    </tr>
    <tr>
      <th>filename</th>
      <td><p>For <code>plotPed</code>: the file name to which the pedigree plot should
    be exported. See <code><a href='FAData.html'>plotPed</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>id</th>
      <td><p>For <code>plotPed</code> and <code>plotRes</code>: the id of the indiviual
    for which the pedigree or the simulation result should be plotted.
    Note: <code>id</code> can be a <code>numeric</code> or a
    <code>character</code>. Numeric ids will be internally converted to
    <code>character</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>The multiple hypothesis testing method. All methods supported by
    <code><a href='https://rdrr.io/r/stats/p.adjust.html'>p.adjust</a></code> are allowed.</p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>Number of simulations.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>The <code>FAIncidenceRateResults</code> object.</p></td>
    </tr>
    <tr>
      <th>only.phenotyped</th>
      <td><p>For <code>plotPed</code>: Wheter only phenotyped individuals,
    i.e. individuals with a non-NA value in column <code>affected</code> (the
    trait information). If <code>TRUE</code>, the function removes all
    non-phenotyped individuals, keeping only those that are required for
    the pedigree to be complete.</p></td>
    </tr>
    <tr>
      <th>strata</th>
      <td><p>For <code>runSimulation</code>: a numeric, character of factor
    characterizing each individual in the pedigree. The length of this
    vector and the ordering has to match the pedigree.
    This vector allows to perform stratified random sampling. See
    details on the <code><a href='FAData-analysis.html'>PedigreeAnalysis</a></code> help page or examples
    for more information.</p>
<p></p></td>
    </tr>
    <tr>
      <th>timeAtRisk</th>
      <td><p>For <code>runSimulation</code>: a numeric vector specifying the time at
    risk for each individual in the given trait. See also
    <code><a href='FAData-analysis.html'>estimateTimeAtRisk</a></code>, an utility function to estimate
    time at risk.
    For <code>familialIncidenceRate</code>: not used.</p>
<p></p></td>
    </tr>
    <tr>
      <th>trait</th>
      <td><p>For <code>familialIncidenceRate</code>: not used.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>For <code>plotRes</code>: at present only <code>"density"</code> is supported.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>For <code>trait&lt;-</code>: can be a named numeric, character or factor
    vector. The names (at least some of them) have to match the ids in
    the pedigree of the object.
    For <code>timeAtRisk</code>: a numeric vector with the time at risk for
    each individual.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>For <code>plotPed</code>: additional arguments to be submitted to the
    internal <code>buildPed</code> call and to <code><a href='FAData.html'>plotPed</a></code>.</p>
<p>For <code>runSimulation</code>: additional arguments <code>prune</code> and
    <code>lowMem</code>. See below for details.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="objects-from-the-class"><a class="anchor" href="#objects-from-the-class"></a>Objects from the Class</h2>

    <p><code>FAIncidenceRateResults</code> objects are created by the
  <code><a href='FAData-analysis.html'>familialIncidenceRateTest</a></code> method on a
  <code><a href='FAData.html'>FAData</a></code> object.</p>
    <h2 class="hasAnchor" id="extends"><a class="anchor" href="#extends"></a>Extends</h2>

    <p>Class <code><a href='FAData.html'>FAData</a></code> directly.</p>
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    <p></p><dl>
    <dt>nsim</dt><dd><p>Number of simulations.</p></dd>
    <dt>sim</dt><dd><p>The result of the simulation. This slot should not be accessed
      directly, use the <code>result</code> method to extract result
      information.</p></dd>
    <dt>timeAtRisk</dt><dd><p>Numeric vector with the time at risk for each individual. Use the
      accessor method <code>timeAtRisk</code> or use <code>object$tar</code> to
      extract this data.</p></dd>
  
</dl>

    <h2 class="hasAnchor" id="methods-and-functions"><a class="anchor" href="#methods-and-functions"></a>Methods and Functions</h2>

    <p></p><dl>

    <dt>object$name</dt><dd><p>Access the familial incidence rate using <code>object$fir</code>, the
      (raw) p-value from the simulation using <code>object$pvalue</code> and the
      time at risk for each individual using <code>object$tar</code> or
      <code>object$timeAtRisk</code> with <code>object</code> being the
      <code>FAIncidenceRateResults</code> object.</p></dd>

    <dt>familialIncidenceRate</dt><dd><p>Returns the familial incidence rate values calculated by a call to
      the <code>runSimulation</code> method or
      <code><a href='FAData-analysis.html'>familialIncidenceRate</a></code> method on a
      <code><a href='FAData.html'>FAData</a></code> object. In contrast to that latter method,
      which directly calculates the values, this method returns the
      values from a calculation stored inside the
      <code>FAIncidenceRateResults</code> object.      The method returns a named numeric vector with the familial
      incidence rates for all individuals in the pedigree, the names
      being the ID of the individuals. Singletons as well as individuals
      that, after removing not phenotyped individuals or individuals
      without time at risk, do not share kinship with any other
      individual in the pedigree have a value of <code>NA</code>.</p></dd>

    <dt>plotPed</dt><dd><p>Plots a pedigree for one of the affected individuals in the
      simulation results. The id of the selected affected individual
      (specified with argument <code>id</code>) is highlighted in red. The
      familial incidence rate value for each individual is drawn below
      the individual's id.
      See <code><a href='FAData.html'>plotPed</a></code> for more details.</p></dd>

    <dt>plotRes</dt><dd><p>Plots the distribution of expected familial incidence rates
      calculated for the selected individuals from Monte Carlo
      simulations along with the actually observed familial incidence
      rate.</p></dd>

    <dt>result</dt><dd><p>Returns the result from the simulation as a <code>data.frame</code> with
      columns:      <code>"trait_name"</code>: the name of the trait.      <code>"total_phenotyped"</code>: total number of phenotyped individuals in
      the trait.      <code>"total_affected"</code>: total number of affected individuals in the
      trait.      <code>"total_tested"</code>: the number of individuals in the pedigree
      considered for the simulation. This corresponds to all individuals
      with valid, non-NA, values in trait, timeAtRisk and eventually
      strata.      <code>"id"</code>: the id of the individual.      <code>"family"</code>: the family id.      <code>"fir"</code>: the familial incidence rate. Note that this will be      <code>NA</code> for all non-phenotyped individuals and singletons in the pedigree as well as for
      individuals that do not share kinship with at least one other
      phenotyped individual with valid time at risk (or valid value in
      parameter <code>strata</code>).      <code>"pvalue"</code>: the p-value for the significance of the familial
      incidence rate assessed by Monte Carlo simulations.      <code>"padj"</code>: the p-value adjusted for multiple hypothesis
      testing (with the method specified with argument <code>method</code>).      The returned <code>data.frame</code> is sorted by column
      <code>"pvalue"</code>, its row names correspond to column
      <code>"id"</code>.</p></dd>

    <dt>runSimulation</dt><dd><p>Performs the simulation analysis based on the pedigree and trait
      information stored in the object as well as the time at risk
      provided with argument <code>timeAtRisk</code>.
      Returns a <code>FAIncidenceRateResults</code> object with the results
      from the simulation.</p></dd>

    <dt>trait&lt;-</dt><dd><p>Set the trait information. This method will reset all simulation
      results saved in the <code>sim</code> slot.</p></dd>

  
</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Monte Carlo simulation and empirical p-value estimation: the
  background distribution to calculate the p-value for a familial
  incidence rate (FIR) is determined by randomly sampling N affected
  individuals (N being the number of affected) and calculating the
  <em>expected</em> FIR for all individuals in each simulation
  iteration. The p-value for an individual represents thus the number of
  times an expected FIR for that individual from the simulation was
  found to be larger than or equal to the observed FIR divided by the
  number of iterations.</p>
<p>Calling the <code>runSimulation</code> method on a <code>FAIncidenceRateResults</code>
  object is the same as calling the
  <code><a href='FAData-analysis.html'>familialIncidenceRateTest</a></code> on a
  <code><a href='FAData.html'>FAData</a></code> object. In the first case the simulation
  is performed using the trait information data stored internally in the
  object, while in the latter case the trait information have to be
  submitted to the function call.</p>
<p>By providing argument <code>strata</code>, the stratified random sampling is
  performed. See example below and the details section in
  <code><a href='FAData-analysis.html'>PedigreeAnalysis</a></code> for more details.</p>
<p>The familial incidence rate can also be directly calculated, without
  simulation, using the <code><a href='FAData-analysis.html'>familialIncidenceRate</a></code> method of a
  <code><a href='FAData.html'>FAData</a></code> object.</p>
<p>A call to the setter methods <code>trait&lt;-</code> resets any simulation
  results present in the <code>sim</code> slot, thus, the object can be
  re-used to perform a simulation analysis using the new trait data.</p>
<p>By default the Monte Carlo p-value estimation in the
  <code>runSimulation</code> method is quite memory demanding. For very large
  pedigrees the optional argument <code>lowMem=TRUE</code> might be passed to
  the method which results in faster and less memory demanding
  calculations. This will however disable the <code>plotRes</code> method on
  the resulting <code>FAIncidenceRateResults</code> as the distribution of
  familial incidence rates from the simulation runs is no longer
  reported.</p>
<p>Note: the FIR for singletons and individuals that do not share kinship
  with at least one other phenotyped individual that has also a valid
  value in argument <code>timeAtRisk</code> (and eventually <code>strata</code>)
  will be <code>NA</code>.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Subsetting (using the <code>[</code> operator) is not supported.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Refer to the method and function description above for detailed
  information on the returned result object.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Kerber, R.A. (1995) Method for calculating risk associated with family
  history of a disease. <em>Genet Epidemiol</em>, pp 291--301.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='FAData.html'>FAData</a></code>,
  <code><a href='FAData.html'>kinship</a></code>,
  <code><a href='FAData.html'>trait</a></code>,
  <code><a href='FAData-analysis.html'>probabilityTest</a></code>,
  <code><a href='FAData-analysis.html'>kinshipGroupTest</a></code>,
  <code><a href='FAData-analysis.html'>kinshipSumTest</a></code>,
  <code><a href='FAData-analysis.html'>genealogicalIndexTest</a></code>,
  <code><a href='FAData-analysis.html'>familialIncidenceRateTest</a></code>,
  <code><a href='FAData-analysis.html'>fsirTest</a></code>,
  <code><a href='FAData.html'>plotPed</a></code>,
  <code><a href='FAData-analysis.html'>estimateTimeAtRisk</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>##########################</span>
<span class='co'>##</span>
<span class='co'>##  Perform the simulation analysis</span>
<span class='co'>##</span>
<span class='co'>## Load the test data.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>minnbreast</span>)

<span class='co'>## Subset to some families and generate a pedigree data.frame.</span>
<span class='no'>mbsub</span> <span class='kw'>&lt;-</span> <span class='no'>minnbreast</span>[<span class='no'>minnbreast</span>$<span class='no'>famid</span> <span class='kw'>==</span> <span class='fl'>4</span> <span class='kw'>|</span> <span class='no'>minnbreast</span>$<span class='no'>famid</span> <span class='kw'>==</span> <span class='fl'>5</span> <span class='kw'>|</span>
                    <span class='no'>minnbreast</span>$<span class='no'>famid</span> <span class='kw'>==</span> <span class='fl'>6</span> <span class='kw'>|</span> <span class='no'>minnbreast</span>$<span class='no'>famid</span> <span class='kw'>==</span> <span class='fl'>7</span> <span class='kw'>|</span>
                    <span class='no'>minnbreast</span>$<span class='no'>famid</span> <span class='kw'>==</span> <span class='fl'>411</span>, ]
<span class='no'>PedDf</span> <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>[, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"famid"</span>, <span class='st'>"id"</span>, <span class='st'>"fatherid"</span>, <span class='st'>"motherid"</span>, <span class='st'>"sex"</span>)]
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>PedDf</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"family"</span>, <span class='st'>"id"</span>, <span class='st'>"father"</span>, <span class='st'>"mother"</span>, <span class='st'>"sex"</span>)

<span class='co'>## Generate the FAData.</span>
<span class='no'>fad</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='FAData.html'>FAData</a></span>(<span class='kw'>pedigree</span><span class='kw'>=</span><span class='no'>PedDf</span>)</div><div class='output co'>#&gt; <span class='message'>Generating the kinship matrix...</span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'>
<span class='co'>## Specify the trait.</span>
<span class='no'>tcancer</span> <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>$<span class='no'>cancer</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>tcancer</span>) <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>$<span class='no'>id</span>

<span class='co'>## Spefify the "time at risk"; we are using column "endage"</span>
<span class='no'>tar</span> <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>$<span class='no'>endage</span>

<span class='co'>## Perform the simulation test:</span>
<span class='no'>far</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='FAData-analysis.html'>familialIncidenceRateTest</a></span>(<span class='no'>fad</span>, <span class='kw'>trait</span><span class='kw'>=</span><span class='no'>tcancer</span>, <span class='kw'>traitName</span><span class='kw'>=</span><span class='st'>"cancer"</span>,
                                 <span class='kw'>timeAtRisk</span><span class='kw'>=</span><span class='no'>tar</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>1000</span>)</div><div class='output co'>#&gt; <span class='message'>Cleaning data set (got in total 174 individuals):</span></div><div class='output co'>#&gt; <span class='message'> * not phenotyped individuals...</span></div><div class='output co'>#&gt; <span class='message'> 43 removed.</span></div><div class='output co'>#&gt; <span class='message'> * individuals with unknown time at risk...</span></div><div class='output co'>#&gt; <span class='message'> 41 removed.</span></div><div class='output co'>#&gt; <span class='message'> * singletons (also caused by previous subsetting)...</span></div><div class='output co'>#&gt; <span class='message'> 17 removed.</span></div><div class='output co'>#&gt; <span class='message'>Done</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='FAProbResults.html'>result</a></span>(<span class='no'>far</span>))</div><div class='output co'>#&gt;       trait_name total_phenotyped total_affected total_tested    id family
#&gt; 16425     cancer              131             12           73 16425    411
#&gt; 16424     cancer              131             12           73 16424    411
#&gt; 16416     cancer              131             12           73 16416    411
#&gt; 16421     cancer              131             12           73 16421    411
#&gt; 16426     cancer              131             12           73 16426    411
#&gt; 16423     cancer              131             12           73 16423    411
#&gt;               fir pvalue       padj
#&gt; 16425 0.010402690  0.001 0.04380000
#&gt; 16424 0.010525802  0.002 0.04380000
#&gt; 16416 0.010189687  0.003 0.04380000
#&gt; 16421 0.010085401  0.003 0.04380000
#&gt; 16426 0.008833302  0.003 0.04380000
#&gt; 16423 0.008211856  0.005 0.06083333</div><div class='input'>
<span class='co'>## We can easily extract the actual FIR values:</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>far</span>$<span class='no'>fir</span>)</div><div class='output co'>#&gt;           1           2           3           4           5           6 
#&gt;          NA 0.002278208 0.002365165 0.000670492 0.002709228 0.002098398 </div><div class='input'><span class='co'>## Or</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'><a href='FAData-analysis.html'>familialIncidenceRate</a></span>(<span class='no'>far</span>))</div><div class='output co'>#&gt;           1           2           3           4           5           6 
#&gt;          NA 0.002278208 0.002365165 0.000670492 0.002709228 0.002098398 </div><div class='input'>
<span class='co'>## Access the p-value directly.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>far</span>$<span class='no'>pvalue</span>)</div><div class='output co'>#&gt;     1     2     3     4     5     6 
#&gt;    NA 0.589 0.573 0.948 0.494 0.602 </div><div class='input'>
<span class='co'>## Access the time at risk</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='fu'>timeAtRisk</span>(<span class='no'>far</span>))</div><div class='output co'>#&gt; [1]       NA 78.05886 55.50000 48.00000 75.00342 53.63997</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>far</span>$<span class='no'>tar</span>)</div><div class='output co'>#&gt; [1]       NA 78.05886 55.50000 48.00000 75.00342 53.63997</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>far</span>$<span class='no'>timeAtRisk</span>)</div><div class='output co'>#&gt; [1]       NA 78.05886 55.50000 48.00000 75.00342 53.63997</div><div class='input'>
<span class='co'>## Plot the pedigree for a family with significant FIRs.</span>
<span class='co'>## The numbers below the IDs of the individuals represent the actual</span>
<span class='co'>## FIR values.</span>
<span class='fu'><a href='FAData.html'>plotPed</a></span>(<span class='no'>far</span>, <span class='kw'>family</span><span class='kw'>=</span><span class='fu'><a href='FAProbResults.html'>result</a></span>(<span class='no'>far</span>)$<span class='no'>family</span>[<span class='fl'>1</span>])</div><div class='img'><img src='FAIncidenceRateResults-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; Did not plot the following people: 16438 16439 16444 16445 </div><div class='input'>
<span class='co'>## Plot also the result from the simulation run.</span>
<span class='fu'><a href='FAGenIndexResults.html'>plotRes</a></span>(<span class='no'>far</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='fu'><a href='FAProbResults.html'>result</a></span>(<span class='no'>far</span>)$<span class='no'>id</span>[<span class='fl'>1</span>])</div><div class='img'><img src='FAIncidenceRateResults-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Johannes Rainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


