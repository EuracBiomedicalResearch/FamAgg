<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Kinship group test — FAKinGroupResults-class • FamAgg</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Kinship group test — FAKinGroupResults-class" />
<meta property="og:description" content="The FAKinGroupResults object contains the results from the
  kinship test. This test performs a familial aggregation
  analysis on a subset of individuals within a family. Two actual tests
  are conducted, a ratio test that evaluates whether the number
  of affected individuals within the group is higher than expected by
  chance, and a kinship test that compares the largest kinship
  value between affected in the group to the one between randomly
  sampled individuals.
For more details see kinshipGroupTest." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FamAgg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.17.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/FamAgg.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/EuracBiomedicalResearch/FamAgg/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Kinship group test</h1>
    
    <div class="hidden name"><code>FAKinGroupResults.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The <code>FAKinGroupResults</code> object contains the results from the
  <em>kinship test</em>. This test performs a familial aggregation
  analysis on a subset of individuals within a family. Two actual tests
  are conducted, a <em>ratio test</em> that evaluates whether the number
  of affected individuals within the group is higher than expected by
  chance, and a <em>kinship test</em> that compares the largest kinship
  value between affected in the group to the one between randomly
  sampled individuals.</p>
<p>For more details see <code><a href='FAData-analysis.html'>kinshipGroupTest</a></code>.</p>
    </div>

    <pre class="usage"># S4 method for FAKinGroupResults
affectedKinshipGroups(object)

# S4 method for FAKinGroupResults
buildPed(object, id=NULL, max.generations.up=3,
                                     max.generations.down=16, prune=FALSE)

&lt;!-- % \S4method{independentGroupCount}{FAKinGroupResults}(object, method="jo") --&gt;

# S4 method for FAKinGroupResults
plotPed(object, id=NULL, family=NULL,
                                    filename=NULL, device="plot", ...)

# S4 method for FAKinGroupResults
plotRes(object, id=NULL, family=NULL,
                                    addLegend=TRUE, type="density", ...)

# S4 method for FAKinGroupResults
result(object, method="BH")

# S4 method for FAKinGroupResults
runSimulation(object, nsim=50000, strata=NULL)

# S4 method for FAKinGroupResults
shareKinship(object, id=NULL)

# S4 method for FAKinGroupResults
trait(object) &lt;- value</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>addLegend</th>
      <td><p>For <code>plotRes</code>: if a legend should be added to the plot.</p></td>
    </tr>
    <tr>
      <th>device</th>
      <td><p>For <code>plotPed</code>: see <code><a href='FAData.html'>plotPed</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>For <code>plotPed</code>: not supported.</p></td>
    </tr>
    <tr>
      <th>filename</th>
      <td><p>For <code>plotPed</code>: the file name to which the pedigree plot should
    be exported. See <code><a href='FAData.html'>plotPed</a></code> for more details.</p></td>
    </tr>
    <tr>
      <th>id</th>
      <td><p>For <code>buildPed</code>, <code>plotPed</code>, <code>plotRes</code> and
    <code>shareKinship</code>: the id of the kinship group (i.e. one of the
    ids in column <code>"group_id"</code> of the result table <code><a href='FAProbResults.html'>result(object)</a></code>).</p>
<p>Note: <code>id</code> can be a <code>numeric</code> or a
    <code>character</code>. Numeric ids will be internally converted to
    <code>character</code>.</p></td>
    </tr>
    <tr>
      <th>max.generations.down</th>
      <td><p>For <code>buildPed</code>: the maximal number of generations to look for
    children.</p></td>
    </tr>
    <tr>
      <th>max.generations.up</th>
      <td><p>For <code>buildPed</code>: the maximal number of generations to look for
    ancestors.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>The multiple hypothesis testing method. All methods supported by
    <code><a href='https://rdrr.io/r/stats/p.adjust.html'>p.adjust</a></code> are allowed.
    <!-- %% The method to calculate the number of independent groups of affected -->
    <!-- %% individuals in the pedigree. Method \code{"jo"} returns the number -->
    <!-- %% of independent groups, i.e. groups that do not share a single -->
    <!-- %% affected individual. Method \code{"daniel"} uses the original code -->
    <!-- %% from Daniel Taliun. --></p></td>
    </tr>
    <tr>
      <th>nsim</th>
      <td><p>Number of simulations.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>The <code>FAKinGroupResults</code> object.</p></td>
    </tr>
    <tr>
      <th>prune</th>
      <td><p>For <code>buildPed</code>: whether the full pedigree should be returned
    (<code>prune=FALSE</code>) or the pedigree should be reduced to a smaller
    pedigree containing only individuals in the kinship group
    (<code>prune=TRUE</code>); see details for more information. Note: the
    <code>plotPed</code> method does also support this parameter.</p></td>
    </tr>
    <tr>
      <th>strata</th>
      <td><p>For <code>runSimulation</code>: a numeric, character of factor
    characterizing each individual in the pedigree. The length of this
    vector and the ordering has to match the pedigree.
    This vector allows to perform stratified random sampling. See
    details on the <code><a href='FAData-analysis.html'>PedigreeAnalysis</a></code> help page or examples
    for more information.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>For <code>plotRes</code>: either <code>"density"</code> (the default) or
    <code>"hist"</code> specifying whether the distribution of expected values
    from the simulation should be visualized as a density plot or
    histogram.</p></td>
    </tr>
    <tr>
      <th>value</th>
      <td><p>For <code>trait&lt;-</code>: can be a named numeric, character or factor
    vector. The names (at least some of them) have to match the ids in
    the pedigree of the object.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>For <code>plotPed</code>: additional arguments to be submitted to the
    internal <code>buildPed</code> call and to <code><a href='FAData.html'>plotPed</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="objects-from-the-class"><a class="anchor" href="#objects-from-the-class"></a>Objects from the Class</h2>

    <p><code>FAKinGroupResults</code> objects are created by the
  <code><a href='FAData-analysis.html'>kinshipGroupTest</a></code> method for <code><a href='FAData.html'>FAData</a></code>
  objects.</p>
    <h2 class="hasAnchor" id="extends"><a class="anchor" href="#extends"></a>Extends</h2>

    <p>Class <code><a href='FAData.html'>FAData</a></code> directly.</p>
    <h2 class="hasAnchor" id="slots"><a class="anchor" href="#slots"></a>Slots</h2>

    <p></p><dl>
    <dt>nsim</dt><dd><p>Number of simulations.</p></dd>
    <dt>sim</dt><dd><p>The list containing the result of the simulation. Element
      <code>"pvalueKinship"</code> contains the p-values from the kinship test,
      <code>"pvalueRatio"</code> the p-values from the ratio test,
      <code>"expDensity"</code> and <code>"expHist"</code> <code>density</code> and
      <code>hist</code> objects representing the background distribution from
      the Monte Carlo simulation.
      This slot should not be directly accessed, use the <code>result</code>
      method to extract result information.</p></dd>
    <dt>affectedKinshipGroups</dt><dd><p>A list of lists, each element representing one kinship group,
      <code>$aff</code> the ids of all affected persons in that group sharing
      kinship with the indivudual (being the id of the group),
      <code>$phe</code> ids of all phenotyped individuals in the pedigree with
      kinship to the individual up to a kinship being smaller or equal
      to the smallest kinship of the indivudal with any other affected
      in that group. <code>$kinfreq</code>: a table with the frequency
      (counts) of kinship values (smaller 0.5). <code>$meankin</code>: the
      mean kinship in that group.</p></dd>
  
</dl>

    <h2 class="hasAnchor" id="methods-and-functions"><a class="anchor" href="#methods-and-functions"></a>Methods and Functions</h2>

    <p></p><dl>

    <dt>affectedKinshipGroups</dt><dd><p>Get groups of affected individuals in the pedigree along with
      all phenotyped individuals with kinship larger or equal to the
      smallest kinship between affected individuals in the
      group. Returns a <code>list</code> of lists with elements <code>aff</code>,
      <code>phe</code>, <code>kinfreq</code> and <code>meankin</code> for each list item:
      <code>aff</code>: character vector with the ids of all affected in the
      group, <code>phe</code>: character vector with the ids of all phenotyped
      in the group, <code>kinfreq</code>: a <code>table</code> with the frequency
      (counts) of kinship values (self-self kinships removed; the names of the
      table correnspond to the kinship values ordered increasingly), and
      <code>meankin</code>: the mean kinship value in the group. The names of
      the list correspond to the id of the affected individual for which
      the affected kinship group was determined.</p></dd>

    <dt>buildPed</dt><dd><p>Builds the pedigree for the submitted id (which represents the id
      of the group, i.e. one of
      <code><a href='https://rdrr.io/r/base/names.html'>names(affectedKinshipGroups(object))</a></code>, respectively ids in
      column <code>"group_id"</code> of <code><a href='FAProbResults.html'>result(object)</a></code>). Building a
      pedigree by submitting the family id is not supported. See details
      below for more information. The resulting pedigree is returned as
      a <code>data.frame</code>.
      <!-- %% Builds the pedigree for the submitted id (which represents the id -->
      <!-- %% of the group, i.e. one of -->
      <!-- %% \code{names(affectedKinshipGroups(object))}). In contrast to the -->
      <!-- %% same method for \code{\linkS4class{FAData}} objects, this method -->
      <!-- %% includes only individuals in the pedigree that are in the selected -->
      <!-- %% group of individuals with eventually included missing mates for -->
      <!-- %% family founders. --></p></dd>

    %% \item{independentGroupCount}{
    %%   Returns the number of independent groups of affected individuals.
    %% }

    <dt>plotPed</dt><dd><p>Plots a pedigree for one of the affected kinship groups in the
      simulation results. The ids of all individuals of the affected
      kinship group are highlighted in the plot in red.
      See <code><a href='FAData.html'>plotPed</a></code> for more details on
      the plotting and details below for additional settings.</p></dd>

    <dt>plotRes</dt><dd><p>Plots the distribution of counts of randomly sampled affected
      counts within the kinship group along with the
      actually observed kinship sum.</p></dd>

    <dt>result</dt><dd><p>Returns the result from the simulation as a <code>data.frame</code> with
      columns:
      <code>"trait_name"</code>: the name of the trait.
      <code>"total_phenotyped"</code>: the total number of phenotyped
      individuals in the trait.
      <code>"total_affected"</code>: the total number of affected individuals
      in the trait.
      <code>"phenotyped"</code>: the number of phenotyped individuals in all
      analyzed kinship groups.
      <code>"affected"</code>: the number of affected individuals in all
      analyzed kinship groups.
      <code>"group_id"</code>: the id for the kinship group (represents the id
      of one of the affected individuals in the group).
      <code>"family"</code>: the family id of the affected/group.
      <code>"group_phenotyped"</code>: the number of phenotyped individuals in the
      current kinship group.
      <code>"group_affected"</code>: the number of affected individuals in the
      current kinship group.
      <code>"ratio_pvalue"</code>: the p-value from the ratio test.
      <code>"ratio_padj"</code>: the p-value from the ratio test adjusted for
      multiple hypothesis testing using the method specified with
      argument <code>method</code>.
      <code>"mean_kinship"</code>: the mean kinship value between all
      individuals in the current kinship group.
      <code>"kinship_pvalue"</code>: the p-value from the kinship test.
      <code>"kinship_padj"</code>: the p-value from the kinship test adjusted
      for multiple hypothesis testing using the method specified with
      argument <code>method</code>.      The <code>data.frame</code> is sorted by column <code>"ratio_pvalue"</code>,
      its rownames correspond to the <code>"group_id"</code>.</p></dd>

    <dt>runSimulation</dt><dd><p>Performs the simulation analysis based on the pedigree and trait
      information stored in the object. Optionally allows to perform
      stratified sampling. Returns a <code>FAKinGroupResults</code>
      with the results of the simulation.</p></dd>

    <dt>shareKinship</dt><dd><p>Returns a character vector with ids of all individuals that share
      kinship with any of the individuals in the kinship group
      identified by the argument <code>id</code>.</p></dd>

    <dt>trait&lt;-</dt><dd><p>Set the trait information. This method will reset all simulation
      results saved in the <code>sim</code> slot.</p></dd>

  
</dl>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Calling the <code>runSimulation</code> method on a <code>FAKinGroupResults</code>
  object is the same as calling the <code><a href='FAData-analysis.html'>kinshipGroupTest</a></code> on a
  <code><a href='FAData.html'>FAData</a></code> object. In the first case the
  simulation is performed using the trait information
  data stored internally in the object, while in the latter case the
  trait information have to be submitted to the function
  call.</p>
<p>A call to the setter methods <code>trait&lt;-</code> resets any simulation
  results present in the <code>sim</code> slot, thus, the object can be
  re-used to perform a simulation analysis using the new trait data.</p>
<p>The <code>buildPed</code> method returns by default the full pedigree (all
  ancestors and all children) up to the maximal number of
  generations. By setting <code>prune=TRUE</code> the method restricts the
  pedigree to all individuals with a kinship &gt;= the minimal kinship
  between the individual (with the id equal to the group id) and any
  other affected individual in its pedigree.</p>
<p>The <code>plotPed</code> method allows to plot the pedigree for a kinship
  group. This pedigree consists of the full pedigree (all ancestors and
  children) of all individuals in the kinship group. Similar to the
  <code>buildPed</code> method the pedigree can be restricted to the kinship
  group (and eventual missing parents etc) by setting <code>prune=TRUE</code>.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Subsetting (using the <code>[</code> operator) is not supported.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Refer to the method and function description above for detailed
  information on the returned result object.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='FAData.html'>FAData</a></code>,
  <code><a href='FAData.html'>kinship</a></code>,
  <code><a href='FAData.html'>trait</a></code>,
  <code><a href='FAData-analysis.html'>probabilityTest</a></code>,
  <code><a href='FAData-analysis.html'>kinshipSumTest</a></code>,
  <code><a href='FAData-analysis.html'>genealogicalIndexTest</a></code>,
  <code><a href='FAData-analysis.html'>familialIncidenceRateTest</a></code>,
  <code><a href='FAData-analysis.html'>fsirTest</a></code>,
  <code><a href='FAData.html'>buildPed</a></code>,
  <code><a href='FAData.html'>plotPed</a></code>,
  <code><a href='plotting-functions.html'>switchPlotfun</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>##########################</span>
<span class='co'>##</span>
<span class='co'>##  Perform the simulation analysis</span>
<span class='co'>##</span>
<span class='co'>## Load the test data.</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>minnbreast</span>)

<span class='co'>## Subset to some families and generate the pedigree data.frame</span>
<span class='no'>mbsub</span> <span class='kw'>&lt;-</span> <span class='no'>minnbreast</span>[<span class='no'>minnbreast</span>$<span class='no'>famid</span> <span class='kw'>==</span> <span class='fl'>165</span> <span class='kw'>|</span> <span class='no'>minnbreast</span>$<span class='no'>famid</span> <span class='kw'>==</span> <span class='fl'>432</span>, ]
<span class='no'>PedDf</span> <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>[, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"famid"</span>, <span class='st'>"id"</span>, <span class='st'>"fatherid"</span>, <span class='st'>"motherid"</span>, <span class='st'>"sex"</span>)]
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span>(<span class='no'>PedDf</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"family"</span>, <span class='st'>"id"</span>, <span class='st'>"father"</span>, <span class='st'>"mother"</span>, <span class='st'>"sex"</span>)

<span class='co'>## Generate the FAData.</span>
<span class='no'>fad</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='FAData.html'>FAData</a></span>(<span class='kw'>pedigree</span><span class='kw'>=</span><span class='no'>PedDf</span>)</div><div class='output co'>#&gt; <span class='message'>Generating the kinship matrix...</span></div><div class='output co'>#&gt; <span class='message'>OK</span></div><div class='input'>
<span class='co'>## Specify the trait.</span>
<span class='no'>tcancer</span> <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>$<span class='no'>cancer</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span>(<span class='no'>tcancer</span>) <span class='kw'>&lt;-</span> <span class='no'>mbsub</span>$<span class='no'>id</span>

<span class='co'>## Perform the kinship group test.</span>
<span class='no'>far</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='FAData-analysis.html'>kinshipGroupTest</a></span>(<span class='no'>fad</span>, <span class='kw'>trait</span><span class='kw'>=</span><span class='no'>tcancer</span>, <span class='kw'>traitName</span><span class='kw'>=</span><span class='st'>"cancer"</span>, <span class='kw'>nsim</span><span class='kw'>=</span><span class='fl'>1000</span>)</div><div class='output co'>#&gt; <span class='message'>Cleaning data set (got in total 587 individuals):</span></div><div class='output co'>#&gt; <span class='message'> * not phenotyped individuals...</span></div><div class='output co'>#&gt; <span class='message'> 257 removed</span></div><div class='output co'>#&gt; <span class='message'>Done</span></div><div class='input'><span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='FAProbResults.html'>result</a></span>(<span class='no'>far</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span>(<span class='no'>res</span>)</div><div class='output co'>#&gt;       trait_name total_phenotyped total_affected phenotyped affected group_id
#&gt; 17609     cancer              330             23        180       20    17609
#&gt; 17517     cancer              330             23        180       20    17517
#&gt; 17547     cancer              330             23        180       20    17547
#&gt; 6607      cancer              330             23        180       20     6607
#&gt;       family group_phenotyped group_affected ratio_pvalue ratio_padj
#&gt; 17609    432                6              5        0.000      0.000
#&gt; 17517    432               53             13        0.000      0.000
#&gt; 17547    432               55             14        0.000      0.000
#&gt; 6607     165              124              6        0.931      0.931
#&gt;       mean_kinship kinship_pvalue kinship_padj
#&gt; 17609    0.2500000          0.000        0.000
#&gt; 17517    0.1458333          0.000        0.000
#&gt; 17547    0.1346154          0.000        0.000
#&gt; 6607     0.1500000          0.803        0.803</div><div class='input'>
<span class='co'>## Plot the pedigree for the most significant kinship group</span>
<span class='fu'><a href='FAData.html'>plotPed</a></span>(<span class='no'>far</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='no'>res</span>[<span class='fl'>1</span>, <span class='st'>"group_id"</span>])</div><div class='output co'>#&gt; <span class='message'>Removing singletons...</span></div><div class='output co'>#&gt; <span class='message'> none present.</span></div><div class='output co'>#&gt; <span class='warning'>Warning: More than 25% of the gender values are 'unknown'</span></div><div class='img'><img src='FAKinGroupResults-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## The full pedigree for this affected individual and its kinship group is</span>
<span class='co'>## large:</span>
<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='fu'><a href='FAData.html'>buildPed</a></span>(<span class='no'>far</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='no'>res</span>[<span class='fl'>1</span>, <span class='st'>"group_id"</span>]))</div><div class='output co'>#&gt; <span class='message'>Removing singletons...</span></div><div class='output co'>#&gt; <span class='message'> none present.</span></div><div class='output co'>#&gt; [1] 262</div><div class='input'>
<span class='co'>## We can however restrict it to a reduced pedigree containing only the</span>
<span class='co'>## kinship group and all individuals with a kinship &gt;= the smallest kinship</span>
<span class='co'>## between the individual and any other affected individual in the pedigree:</span>
<span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span>(<span class='fu'><a href='FAData.html'>buildPed</a></span>(<span class='no'>far</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='no'>res</span>[<span class='fl'>1</span>, <span class='st'>"group_id"</span>], <span class='kw'>prune</span><span class='kw'>=</span><span class='fl'>TRUE</span>))</div><div class='output co'>#&gt; <span class='message'>Removing singletons...</span></div><div class='output co'>#&gt; <span class='message'> 1 removed.</span></div><div class='output co'>#&gt; [1] 8</div><div class='input'>
<span class='co'>## By specifying prune=TRUE we can restrict the pedigree plot to these</span>
<span class='co'>## individuals</span>
<span class='fu'><a href='FAData.html'>plotPed</a></span>(<span class='no'>far</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='no'>res</span>[<span class='fl'>1</span>, <span class='st'>"group_id"</span>], <span class='kw'>prune</span><span class='kw'>=</span><span class='fl'>TRUE</span>)</div><div class='output co'>#&gt; <span class='message'>Removing singletons...</span></div><div class='output co'>#&gt; <span class='message'> 1 removed.</span></div><div class='img'><img src='FAKinGroupResults-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## Get the ids of all individuals sharing kinship with any of the inddividuals</span>
<span class='co'>## in that kinship group:</span>
<span class='fu'><a href='Pedigree-utils.html'>shareKinship</a></span>(<span class='no'>far</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='no'>res</span>[<span class='fl'>1</span>, <span class='st'>"group_id"</span>])</div><div class='output co'>#&gt;   [1] "17516" "17517" "17518" "17519" "17520" "17521" "17522" "17523" "17524"
#&gt;  [10] "17525" "17526" "17527" "17528" "17529" "17530" "17531" "17532" "17533"
#&gt;  [19] "17534" "17535" "17536" "17537" "17538" "17539" "17540" "17541" "17542"
#&gt;  [28] "17543" "17544" "17545" "17546" "17547" "17548" "17549" "17550" "17551"
#&gt;  [37] "17552" "17553" "17554" "17555" "17556" "17557" "17558" "17559" "17560"
#&gt;  [46] "17561" "17562" "17563" "17564" "17565" "17566" "17567" "17568" "17569"
#&gt;  [55] "17570" "17571" "17572" "17573" "17574" "17575" "17576" "17577" "17578"
#&gt;  [64] "17579" "17580" "17581" "17582" "17583" "17584" "17585" "17586" "17587"
#&gt;  [73] "17588" "17589" "17590" "17591" "17592" "17593" "17594" "17595" "17596"
#&gt;  [82] "17597" "17609" "27621" "27623" "27624" "27625" "27626" "27627" "27628"
#&gt;  [91] "27629" "27630" "27631" "27632" "27633" "27634" "27635" "27636" "27637"
#&gt; [100] "27638" "27639" "27640" "27641" "27642" "27643" "27644" "27645" "27646"
#&gt; [109] "27647" "27648" "27649" "27650" "27651" "27652" "27653" "27654" "27655"
#&gt; [118] "27656" "27657" "27658" "27659" "27660" "27661" "27662" "27663" "27664"
#&gt; [127] "27665" "27666" "27667" "27668" "27669" "27670" "27671" "27672" "27673"
#&gt; [136] "27674" "27677" "27680" "27681" "27682" "27683" "27684" "27685" "27686"
#&gt; [145] "27687" "27688" "27689" "27690" "27691" "27692" "27693" "27694" "27695"
#&gt; [154] "27696" "27697" "27698" "27699" "27700" "27701" "27702" "27703" "27704"
#&gt; [163] "27705" "27706" "27707" "27708" "27709" "27710" "27711" "27714" "27715"
#&gt; [172] "27716" "27717" "27718" "27719" "27720" "27721" "27722" "27723" "27724"
#&gt; [181] "27725" "27726" "27727" "27728" "27729" "27730" "27731" "27732" "27733"
#&gt; [190] "27734" "27735" "27736" "27737" "27738" "27739" "27741" "27743" "27744"
#&gt; [199] "27745" "27746" "27747" "27748" "27749" "27750" "27751" "27752" "27753"
#&gt; [208] "27754" "27755" "27756" "27757"</div><div class='input'>
<span class='co'>## Plot the simulation analysis result for the ratio test.</span>
<span class='fu'><a href='FAGenIndexResults.html'>plotRes</a></span>(<span class='no'>far</span>, <span class='kw'>id</span><span class='kw'>=</span><span class='no'>res</span>[<span class='fl'>1</span>, <span class='st'>"group_id"</span>], <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"hist"</span>)</div><div class='img'><img src='FAKinGroupResults-3.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Johannes Rainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


